<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Bosen Hu" />

<meta name="date" content="2023-12-10" />

<title>Homework for SA23204161</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework for SA23204161</h1>
<h4 class="author">Bosen Hu</h4>
<h4 class="date">2023-12-10</h4>



<div id="homework-0" class="section level1">
<h1>Homework 0</h1>
<div id="questions" class="section level2">
<h2>Questions</h2>
<p>Use knitr to produce at least 3 examples. For each example, texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p>
</div>
<div id="answers" class="section level2">
<h2>Answers</h2>
<div id="example-1" class="section level3">
<h3>Example 1</h3>
<p>Example 1 shows the figure of the function <span class="math inline">\(f(x)=\sin(x)\)</span>, where <span class="math inline">\(x\in[1,10]\)</span>. The values of <span class="math inline">\(y=f(x)\)</span> are also listed below when <span class="math inline">\(x\)</span> takes partial values.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">sin</span>(x)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">data.frame</span>(x,y)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="at">mapping =</span> <span class="fu">aes</span>(x,y))<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">theme_light</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;The figure of fuction y=sin(x).&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(data), <span class="at">align =</span> <span class="st">&quot;c&quot;</span>, <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">x</th>
<th align="center">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1.0</td>
<td align="center">0.8415</td>
</tr>
<tr class="even">
<td align="center">1.1</td>
<td align="center">0.8912</td>
</tr>
<tr class="odd">
<td align="center">1.2</td>
<td align="center">0.9320</td>
</tr>
<tr class="even">
<td align="center">1.3</td>
<td align="center">0.9636</td>
</tr>
<tr class="odd">
<td align="center">1.4</td>
<td align="center">0.9854</td>
</tr>
<tr class="even">
<td align="center">1.5</td>
<td align="center">0.9975</td>
</tr>
</tbody>
</table>
</div>
<div id="example-2" class="section level3">
<h3>Example 2</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>resources<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">book_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">book_name =</span> <span class="fu">c</span>(<span class="st">&quot;Statistical Computing with R&quot;</span>,<span class="st">&quot;Advanced R&quot;</span>,<span class="st">&quot;R for Beginners&quot;</span>,<span class="st">&quot;Guidelines for Statistical Projects&quot;</span>,<span class="st">&quot;Data Manupilation with R&quot;</span>,<span class="st">&quot;R Graphics Cookbook&quot;</span>))</span></code></pre></div>
<p>Other textbooks and resources are listed below.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">kable</span>(resources, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Resources of class Statistical Computing&quot;</span>)</span></code></pre></div>
<table>
<caption>Resources of class Statistical Computing</caption>
<thead>
<tr class="header">
<th align="center">book_id</th>
<th align="center">book_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">Statistical Computing with R</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">Advanced R</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">R for Beginners</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">Guidelines for Statistical Projects</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">Data Manupilation with R</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">R Graphics Cookbook</td>
</tr>
</tbody>
</table>
</div>
<div id="example-3" class="section level3">
<h3>Example 3</h3>
<p>We will use the dataset <strong>women</strong> to perform linear
regression between variable <em>height</em> and <em>weight</em>. We
suppose the form of the regression is <span class="math display">\[h=a\times w+b,\]</span>where <span class="math inline">\(h\)</span> represents <em>height</em>, <span class="math inline">\(w\)</span> represents <em>weight</em> and <span class="math inline">\(a,b\)</span> are weights.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>data<span class="ot">&lt;-</span>women</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>weight,data<span class="sc">$</span>height,<span class="at">xlab =</span> <span class="st">&quot;weight&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;height&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Scatter plot of height and weight.&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAxlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmZmZmkJBmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQ27aQ29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa2tma227a229u22/+2/7a2/9u2///bkDrbtmbbtpDb27bb29vb/7bb////tmb/25D/27b//7b//9v///8QCyWqAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALuUlEQVR4nO2dDXvbthHHIcfupKRvqZS0WxN76ZpVTLsXb2aTTXQkfv8vVRwOIAFJ4JEUQEDW/Z8nikzi7sAfwQNIgaSoWZ0SqSuQuxgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFyAe3+8aUQs2/vOwx2vz40n7R2d+Jmc8zBQcEPCyFeqq+lmK37eHLK9a1QIa6ogm4ksbdKaXbrtf78GgLgZw8dbpbHtIK4S/V1DKDeFToNUCm0/E4wQI8wx4J11NDa2uOAOk36V6h3QSMHUCFmb+XekO1INaHf5fH27C18+/haUvtqDSUA3w8a4u6DbG0vN1jZn1+Lq3tTiX99L8T1fQvoo/z72Y8b48DU0V2st1f6+kU6vlZ/NSG0p51aozbTKud4bSq772khrt83gArlrlCbWsGnL9IRvI8L1dgLbE1L3f7VBjiAtiu1+PrBtD3dWLQhlNfBdNOUX51N2VvcAGqbcRsCPWESmH2JgJpytte2sk0J+G7SR1tMLgX3S9xubyQbkHQ4+/Hf+g8Z6LvN55W0lWX/tNHY7EOsgCaDi6XlzX39P8MZVvwuxFwHk2XkZylaB0r2YucQA19NaR0CPclKzTe7QmhAdjnt1a5sqZpxaXaytPzQAJIlbuEDKzn3R7IBacrX7zdNcyq/RWCfoH+bO4Ak86XaHqxsm9ix3apCGExXv8Cd3QCyF7uAbmv0boWwPW1XbUws4qYWU1ksIbe6qTha6m2dqyZ29QCs/JFqR5B27Iamwb3D1ukCAvymBTuJVdcWlikvxlWJB6m1r9vFB0laVm1uh3A8WUxVORuQVVmrhOJR2wVL6aoQX6xm6xIheSLVe9p9+qltd23Duv7bp9UeoEp0A4LUp+LgNuhc2NbQWXwckBXC8dQByK6sVcKxrDHs7O8r8fZOLCFf+yNZbHRytg8Oa/l2H5A6ip2NitGCTIi+LciurNuCWkuzf75ZQPP5Ao4ufyQLkDSZvZFLPy7aZFF99R538WGSNpCPADoxBx3s9wanm4OOAbIre1iizUHY2WLTwf7ME8kC1A4UobC0fAkgxa3qbWB01OwU/FTDJtnPqa7IBeTvxayS3l7M3iwT4lgv1pZrzQ8riyVsywYl7gM9IvJEsgG5Y4XCsGoWYxy5Fj/10KElZu0a7eVgHKQdODsESxwF1IY4Ng5yNl97tStrl7Br1aCE8SGy9EeyAdU71YupsW2tR9JvauwYrt+XZvB8fY+f9ed3MoY6td3PQf99hyuckfQbFQJNUe1iD6A2hDW+/fr+IAdZXq3KOp52vy3keYHd3d2Z0aTKPr5IdXgNPt8ZEWH/GkG8SFGcRgNUqGsiOPSLqyZSFN/RAJnhSr/z/RCRzgxQ/fn7BXVJL2wkvuRKiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEAgMSZ6NUgMK6iyDNhgF5JKx/vQ0Cx89ZwnxODGj4oZ1IqQDFchdcDIgS5yBK3Iv1EwMy8nQcDEjLl28iATI3Qnin+eYGSFifR1b09tBTpb6frK7Ml5PcTaBpAe3uGiyl516Jywa0XTV3GFaegyw3QNPmoDNsQRP3YqW5rzPjHNTzfDBSL6Zvy/PfrZUcUN/TiEsdB3mT8vGCvT2eqmwud6QFtF2RN0JeOqBvFp7kPMZdFCXNQdvVUnZknXeLJgeUtBcDQHiHfhB3wTQm9UUEVCtGGY2kB10gtI3CFqwtQGHcBVLvvHzEKmTBmgGFEAOa1l3vmHnkoOnd9QyaSy82vbt4euqATj7re+KARqWdAw9hCyZx1xnlpFjDAW1f4RNnfFebu71Me7kjKaDypEfbPFlARdsGyNFykLinKUUOMi3oNHEvNq0713fIDDcCEPm7e9C441yHcz8CUBHiwWPxAAVIzIfuhhTscS0jZNyRnpMC8r8KIULckZ4TAtrdhXh241POQY+LAE3oqfZi5jf3nHuxsHo646BI53dPBlDYzOP6HVbQOspOyEWhtyVw37XveFBBnBRVwSsmBo+Iol3uyAiQ6ebLm41vfl3IuIP8ZQHIDBSrq4dR18wGxh3iMI8cZGZoQgvKCFBGvViTg04ZUwfZmCmu3I7p5lU/Bq8GOWGoGGLLYh1VB0HCFrTUcVISYMOi5eUjUUIWrHudkFw2IDN//AJbkBwbNs2jKwPhPNe4gM48BxWzdWxA2fZi/VSKZSRAk05DH9nN32wK8jzscfEsCqBJjiwn2sCC1WxdwqvrSEK7O//5/vgtnCY374UbUhBONeAsddR5RoCz+ewBwckqAOo8Uy30yzG97x56woBMCyo6rnUoPs/XHb8RPf0cVHZcT1T5qVBnsjFuyTyHXqz7xV3QbvRVkbO5qdenOOMgaD1l4BaU6Ca8OIC2K3hz6lIdjgHcGYMUhEYA6jX9Rb/YzntFbei2Ttx37QceVDDJ9JczApRm+stZAUoy/eV8clCq6S/n04tNO/0l9S32g68oTjz9JdWR5VQgbMGg7pLl5r0ahCzY7WXg5Y6LAzTUHQPqU45zUGfB8+rFpoqbGkurPAElP7BaZQkofWpuxYAIMSBCWQLiHMS92NTu4ikrQPm0m1Y5Acoo87TKCFBOfVerjC53MCDCHQOi3HEOotxxL3bcXY5cGmUAKMsjq1EkQIUQczXJwfcTmtj7li2hOIDUFD2Y2uH9If+yAVlTg+gJVJcISM1vwMl3PabgXWAOGtSCLrIXa3KQ9QqSI+6yJqOVshfL+9jSSjgOyjw7ayU8m79gQM1D/ztfwHbpgFT/1XmvxuXmIACk0XR28xfbiwEgPZOR79U4pj4t6GwUBxB4nteDZ51TQVKvD2grGclTDe8L6kYGSb0+lm2wIKnXx7INFiT1+li2wYKkXh/LNliQ1Otj2QYLknp9LNtgQVKvj2UbLEjq9bFsL0IMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIRAT2+gN/O1GQQfO5Z9xPSPPYgfDLfSHt4rOF8THxUPEDwPC/gIytVQg1h5pX30V5ee1AlANBI+0rablcj4mtFA1ThFAf8JbbUzz7TDxkcYF/rZ8zWI+3RbER8o1iAKrG0fp6We64hNdi+vPmrBDTSXj0XEzTQvlHEHGQBKq4esKZDXtmhy0pDyEEj7aur/6xUDhxuj5oEEPwSi4f/kCSA9nBoAKCR9iUcaPB0reH2qCkAVSZHjwFkni87FtBMN5yMAeEv+SMPEWV2wiGGSUcmoHwPsdJ+lcKQJKkPEdTtSHushKSTbZI2jxce3s22e7sY0c1re5zPVOXXzdfmEFmYmTKDB2ouoLH2pYGb20DRPUSgYuXAof4eoLH2lTnVGWqP4pNVQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMilD0g51lOzR9ViDdW9lL2gBwZQGFe6dlLDIhQToDUm0wrmHAF811KnLaCLAohZj/N1tvVXxZqtpkQnic8BVdOgNRkJ5iVDxOeYPYlzL5SgOA1y5UAQDBvH/6/yBakJoAVf77ZPD5f60cSXj0AC5xfWMxwqfzrUgHJ7d6++vnFQzNrV7PQTyDWLQdKXSigulg+fv3/V+tibt7bLhSLkgFplTe/zeviu7vbdroltyBbjy9+kOn52fN125G3OahkQLXqpfD2MHUPQaGZtL2YATTsMXwnKC9AioSeWg3jIPlXMw66+id2aWpJcZnjoG4Nv88ihM4CkMpBEx5Wts4CEHb6k+VlR+cBKKEYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCE/gCX3RfMkE+j7wAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">align=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">height</th>
<th align="center">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">58</td>
<td align="center">115</td>
</tr>
<tr class="even">
<td align="center">59</td>
<td align="center">117</td>
</tr>
<tr class="odd">
<td align="center">60</td>
<td align="center">120</td>
</tr>
<tr class="even">
<td align="center">61</td>
<td align="center">123</td>
</tr>
<tr class="odd">
<td align="center">62</td>
<td align="center">126</td>
</tr>
<tr class="even">
<td align="center">63</td>
<td align="center">129</td>
</tr>
<tr class="odd">
<td align="center">64</td>
<td align="center">132</td>
</tr>
<tr class="even">
<td align="center">65</td>
<td align="center">135</td>
</tr>
<tr class="odd">
<td align="center">66</td>
<td align="center">139</td>
</tr>
<tr class="even">
<td align="center">67</td>
<td align="center">142</td>
</tr>
<tr class="odd">
<td align="center">68</td>
<td align="center">146</td>
</tr>
<tr class="even">
<td align="center">69</td>
<td align="center">150</td>
</tr>
<tr class="odd">
<td align="center">70</td>
<td align="center">154</td>
</tr>
<tr class="even">
<td align="center">71</td>
<td align="center">159</td>
</tr>
<tr class="odd">
<td align="center">72</td>
<td align="center">164</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">lm</span>(height<span class="sc">~</span>weight, <span class="at">data =</span> data)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="fu">summary</span>(model)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">print</span>(s)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = height ~ weight, data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.83233 -0.26249  0.08314  0.34353  0.49790 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 25.723456   1.043746   24.64 2.68e-12 ***
## weight       0.287249   0.007588   37.85 1.09e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.44 on 13 degrees of freedom
## Multiple R-squared:  0.991,  Adjusted R-squared:  0.9903 
## F-statistic:  1433 on 1 and 13 DF,  p-value: 1.091e-14</code></pre>
<p>By function <strong>lm()</strong> and <strong>summary()</strong>, we
obtain two significant regression coefficients <span class="math inline">\(a=\)</span> 0.2872492 and <span class="math inline">\(b=\)</span> 25.7234557. The <span class="math inline">\(R^2\)</span> is close to 1. Hence, the regression
equation is <span class="math inline">\(h=\)</span> 0.2872492 <span class="math inline">\(\times w+\)</span> 25.7234557.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>weight,data<span class="sc">$</span>height,<span class="at">xlab =</span> <span class="st">&quot;weight&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;height&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Scatter plot of height and weight.&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">coef</span>(s))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAxlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmZmZmkJBmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQ27aQ29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa2tma227a229u22/+2/7a2/9u2///bkDrbtmbbtpDb27bb29vb/7bb////tmb/25D/27b//7b//9v///8QCyWqAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMtklEQVR4nO2dDXvbthHHIcfupKRvqZS0W1N76ZpNzLoXb2aTTXIsfv8vVQAHgAAl8AgQIKHo/s8TRSYPd+BPIF5IEGQNqVds7gyULgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIhcQId/fMnY4tv7ngSHvz+YT1yHO3azO+XgyPD9irGX8mvNFtshnhy7oRmq2BVm6EZinV1Si1tv6k+vRQD4HKDjw/Ik3Yu4a/k1BtDgDI0DVDMlvxMIMCDMqWA9ObSO9jSg3iTDMzTYUMsBVLHFT/zX4OVIFqHf+Pn27Cfx7cNrTu2rrbAQ+H5QEA/veWl7uYPM/vKaXd3rTPzre8au71tAH/jfz37caQc6j+5mdbzc19+442v5lwmhPB3kHnmYlp3j1WS262nFrt8ZQJV0V8lD3YtPX6QTeB9XsrBXUJrWqvzLA3AAPW3k5usHXfZUYVEJhb0Kpoom/+ocSmezAdQW4zYEeIJKYPElADJ2ttc2s8ZCfNfVR2vGtwr3azhubyQbEHe4+PHf6g8e6Lvdpw1Py23/sFPY7FOsEkUGNvOUN/fN/zRnseM3xpYqGLfhnzVrHUjZm51TTPgy1ioEeOKZWu4OFVOAbDvl1c5sLYtxrX9knvK9AcQtbsUHZHLpj2QDUpSv3+1Mcaq/BWAfRfu2dABx5mt5PJDZtmKHciuNIJjKfgU/tgFkb3YB3Tbg3Qphe3ratDHBxK1adGbBgh+1yTikVMe6lEXs6kGw8kdqHIlqxy5oCtxbKJ0uIIFfl2CnYlW5FdukF+2qhpPU+q3bzUeVNM/a0g7heLKYSjsbkJVZy0LyaGzDmruq2BebxbYGSJ5ITUeHjz+35a4tWNd/+bjpANqzfkCi6pNx4BhUXdjm0Nl8GpAVwvHUA8jOrGXhpGwg7OKvG/bTHVuL+tofyWKjKmf75LC2P3UBybPYOagcJUiHGFqC7My6JahNqX+fb1ai+Hwhzi5/JAsQT7J4w7d+WLWVxf6rd/ATH1fSGvIJQCProKPf3eB066BTgOzMHlu0dRA0tlB0oD3zRLIAtR1FYcxTvhQg2a1sbUTvyPwo8Cm7Tbydk02RC8jfilmW3lbMPiwd4lQr1tq1yY8zCxZ2SoMSfgPVI/JEsgG5fYVKszKbIQ7fC5+q69ASs34a5eWoH6QcOD8IWJwE1IY41Q9yDl95tTNrW9i5MihF/xBY+iPZgJqDbMVk37ZRPek3DTQM1+9q3Xm+vofP5tNbHkMObbt10H/fwg6nJ/1GhoCkoHazB1Abwurffn1/VAdZXq3MOp4Ov674uMBu7u50b1LWPr5ITXoFj3ciInSvEeSLlMVpNkCVvCYCXb+8MpGy+M4GSHdXho33U0Q6M0DNp+9X2CW9tJHokisiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACFKDIidjeYClNZdYgksig0BOiHW+Tc4UeI8FCrWcmGTAwo/tScXcz+pBLnSvxwBOi3mfKM6qCPnxKdW7Egn80SAtDwNBwFS8tU3mQDpByG803wLA8Tsxt3dM9hFSLxaPU/W7PWXUe6yizXTAjrcGSy151mJkgAx092ZCtDTxjxhuPecZAUBatlMVgedUwkybdekrVitn+ssuA5izFdoXLPB/oKiq8fy/E9rzQ5I0hkwZr7UfhAMIwbk4lIvd8hLhkMOKlMrhj4IOT+ggUP1TIC+WXkq5xh3OTSshh5oE2bYCEBr3pD1Pi06LyDrojxqOthnQHwBCJ7QT+IumZh/yOVPk9yw0YAayaignrQ6q8IaiLyA0rhLJFV6AiNfGqDg/sUFdRThDCNAPTGHdQ07iZIbzuJuWMyYDvzlAIoc3XzugJh7qzTCQXLDWdz1hYELG2M8pDWcxV1vlIiquesixPDpFaw447va3O9l2ssdcX3DEy5CDDWgetTSNhMCGvdjhAKq2jKA9paTxB0nNnTQ3uMh1FCXoHGavBWLdpDccBZ3rm/rVs54Z+GG6H33pHHjXIdf9+nzFmhYpVh4LB8gwyZNSxlRB+HXMlLGjfQ8qu9z7C7E0LrxPkXcSM/JOlrhgA53KdZunKQOSuUt0PBxlaAITdOKpXAWZqjvuZfciqX1/fn0g8w9nbSuPxtArEld+7R+wwyts2xEXZTnODJcJYgoQTApai9eMRHcI8p2uSNd1/mk4xBD3czXNzvf/LqUcQP8ZbnKFN9R3F89RF0zC4w73GGyznPHb6ihnqEpSlBJgDJdpRxTB43pU6cZSLZMsvWrYpp52Y6JV4OM6CqmuhKRpe/TDZLW0FLPoCTBEbUNVxHd8pBMDBiQJASU9w5JnhKk5o9PUoIyX90OHqyuTfHoq4FgnmteQCNvmQYESWuoVC22uQHl6Rl2YyQ31KrZOhOgdkLCBDePIpv5m12FjsMeV8+yADLt1iT31mI6iottLV5dhxI63PnH+/EHN03j1QkXYiiGGmKUGjXOSDCan6bx6oQLMRSDVQGod6RaqZdjet89NBLQdA/DxJegqudah+TzfNtzj2hcHTThw0LRdVDdcz1R1k+VHMnmeCRz0oepogerfS/uEuVGXRXJ8FDvhHRCogVlS5SeOnEJ0ouNTMsnE6CnjXhz6lqejgnc6QRs6uLTRAEaNP1FvdjOe0Ut9EAnbty7gYMMZ5n+MsvpZQIHGc4z/QXa9jMBNMv0FzZHBdSMuS82UVxtP9ej5BF10LTTXwauIJFNwVcUJ57+ku2O6VBlvasx3t1sjZebg6SG/V4CL3fM1njZOUhsmNTd3DXQGQBKHzpMRQMKWEEimwoFxObqFx6pTECT3BIcpiIBQcVDgHp2FnOGFQpouvuCqEoENH/nx1KBgGYffjkqDlAxZJSKAlTA8oFHKgnQ+Ge4M6ggQIOXNpxUBV3uKKlxb1VOCYpYwm8KlQJId51L41MKIH3jtDg+RQAqkYtRAYDKGZieUiZAFWNLOcnBdwutdVdm42WUB5Ccoiemdnhv5Bt3hTZeRlkAWVODkAlUrOeVH2UoCyA5vwEm3/VPwTNnV7F8Zi1B7RMF5fLJXQdZryA5clfk2PRIs7VirMyx6ZFm7AcVXjsrzTiav2BAZtH/3hewXTog2X71PqtxuXWQAKTQ9HYUL7YVE4DUTMYzeAFbv2YrQWejPICE52UTPOscCzL3/oRpOSM+1PC+oC4yyNz7c6VNFmTu/bnSJgsy9/5caZMFmXt/rrTJgsy9P1faZEHm3p8rbbIgc+/PlTZZkLn350p7ESJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAIcoI6PGFuHcmJ4PAumf9K6R50gvBynyR6cWyhsuY+KB8gMR6XoIPz1QtcihmXnmX9vKmF9ozASgy/Z6nfdpExFfKBmgPUxzgTmyt1j5TiwwGpG/UGrNNZHpIFhFfKxegPVtbt6f5L2dIBaevb/7MAUWml+tiCgWmN8pYB1mAqqsHyGnIKzuULU8o6qDI9Pur/2xkHRieHjQJIHEnFk7/kEoA0otTQwCKTF+LE02srhWeHjQFoL2uo2MA6fVlYwEtVMEpGBDcyY88RWSyEacYVDq8Air3FKvtVymEVJLqFAHdRqaHTHA6xVbSennh8Ga2/bWriGZepYf5TPvymvlGnyIrPVMmuKPmAopNX2u4pXUU3VNEZKwO7Op3AMWm3+uhTmh6EA1WEREgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIUfGAnLWczB/7FG+sHKTiATnSgNK80nOQCBCikgDJN5nuxYQrMd+lhmkrwKJibPHzYvu0+dNKzjZjzLPCU3KVBEhOdhKz8sWEJzH7Usy+koDEa5b3TAAS8/bF/xdZguQEsOqPN7vH51u1JOHVg2AB8wurBWzlf10qIH7cT69+efFgZu0qFmoFYlVyhNWFAmqq9ePX/3+1rZb6ve1MsqgJkFJ98+uyqb67u22nW1IJsvX44gdePT97vm0b8rYOqglQI1speDxMPkNQKSZtK6YBhS3DN0JlAZIk1NRq0Q/if5l+0NU/oUmTW6rL7Af1K/w5ixQ6C0CyDprwtLJ1FoCg0Z+sXnZ0HoBmFAFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECNHvNrH1t12/GzsAAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
</div>
<div id="homework-1" class="section level1">
<h1>Homework 1</h1>
<div id="questions-1" class="section level2">
<h2>Questions</h2>
<p><strong>Exercise 1</strong>.
利用逆变换法复现函数sample的部分功能(replace = TRUE)，并举例.</p>
<p><strong>Exercise 3.2</strong>. The standard Laplace distribution has
density <span class="math inline">\(f(x)=\frac{1}{2}e^{−|x|}, x\in
R\)</span>. Use the inverse transform method to generate a random sample
of size 1000 from this distribution. Use one of the methods shown in
this chapter to compare the generated sample to the target
distribution.</p>
<p><strong>Exercise 3.7</strong>. Write a function to generate a random
sample of size n from the Beta(<span class="math inline">\(a,
b\)</span>) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
<p><strong>Exercise 3.9</strong>. The rescaled Epanechnikov kernel [85]
is a symmetric density function <span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2),~~~~|x|\le
1.\tag{3.10}\label{3.10}\]</span>Devroye and Gyrfi [71, p. 236] give the
following algorithm for simulation from this distribution. Generate iid
$U_1, U_2, U_3 $Uniform(−1, 1). If <span class="math inline">\(|U_3|≥|U_2|\)</span> and <span class="math inline">\(|U_3|≥|U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random
variates from <span class="math inline">\(f_e\)</span>, and construct
the histogram density estimate of a large simulated random sample.</p>
<p><strong>Exercise 3.10</strong>. Prove that the algorithm given in
Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span> (<span class="math inline">\(\ref{3.10}\)</span>).</p>
</div>
<div id="answers-1" class="section level2">
<h2>Answers</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>SEED<span class="ot">&lt;-</span><span class="dv">20230918</span></span></code></pre></div>
<div id="exercise-1" class="section level3">
<h3>Exercise 1</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>my.sample<span class="ot">&lt;-</span><span class="cf">function</span>(data, <span class="at">size =</span> <span class="fu">length</span>(data), <span class="at">prob =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(data),<span class="fu">length</span>(data))){</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="co">#Default: Assume &quot;data&quot; has &quot;n&quot; elements, and &quot;n&quot; samples will be drawn, whether the element will be drawn obeys uniform distribution.</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="co">#The &quot;replace&quot; option is &quot;TRUE&quot;.</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">set.seed</span>(SEED)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  cum.prob<span class="ot">&lt;-</span><span class="fu">cumsum</span>(prob)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">runif</span>(size)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  result<span class="ot">&lt;-</span>data[<span class="fu">findInterval</span>(U,cum.prob)<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>}</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="fu">my.sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 2 1 2 2 4</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">my.sample</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">size =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] 7 6 7 7 9 9 9 8 8 8</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">my.sample</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>,<span class="at">prob =</span> <span class="fu">seq</span>(<span class="dv">1</span>,.<span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">1</span>)<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">seq</span>(<span class="dv">1</span>,.<span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>##  [1] 12 11 13 12 15 16 15 14 14 14</code></pre>
</div>
<div id="exercise-3.2" class="section level3">
<h3>Exercise 3.2</h3>
<p>We know that the probability density function of Laplace distribution
is <span class="math display">\[
f(x)=\left\{
\begin{matrix}
\frac{1}{2}e^x,~~~~x\le 0 \\
\frac{1}{2}e^{-x},~~~~x&gt;0.
\end{matrix}
\right.
\]</span> Hence, the cumulative density function of Laplace distribution
can be obtained as: <span class="math display">\[
F(x)=\left\{
\begin{matrix}
\frac{1}{2}e^x,~~~~x\le 0 \\
1-\frac{1}{2}e^{-x},~~~~x&gt;0.
\end{matrix}
\right.
\]</span></p>
<p>By the inverse transform method, the sample obeys Laplace
distribution can be obtained. The inverse function is <span class="math display">\[
F^{-1}(x)=\left\{
\begin{matrix}
\log{2x},~~~~x\in[0,\frac12] \\
-\log{2(1-x)},~~~~x\in(\frac12,1].
\end{matrix}
\right.
\]</span></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">set.seed</span>(SEED)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>U<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>U[U<span class="sc">&lt;=</span><span class="fl">0.5</span>])</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>U[U<span class="sc">&gt;</span><span class="fl">0.5</span>]))</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">c</span>(X1,X2)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">main =</span> <span class="st">&quot;Laplace distribution&quot;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>),<span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,.<span class="dv">02</span>)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="fu">lines</span>(d,<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="fu">abs</span>(d)),<span class="at">col =</span> <span class="st">&quot;red&quot;</span>,<span class="at">lwd =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>Comparsion</strong>: By acceptance-rejection method. We
ignore some parts where <span class="math inline">\(|x|&gt;10\)</span>
since <span class="math inline">\(e^{-10}&lt;10^{-5}\)</span> is small
enough. Take U(-10,10) as suggestive distribution, <span class="math inline">\(c=20\)</span>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">set.seed</span>(SEED)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>iter<span class="ot">&lt;-</span>count<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>X.ar<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="cf">while</span>(count <span class="sc">&lt;</span> n){</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  iter<span class="ot">&lt;-</span>iter<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  Y<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="at">min =</span> <span class="sc">-</span><span class="dv">10</span>,<span class="at">max =</span> <span class="dv">10</span>)</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="fu">abs</span>(Y))<span class="sc">&gt;</span>U){</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>    count<span class="ot">&lt;-</span>count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>    X.ar[count]<span class="ot">&lt;-</span>Y</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>  }</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>}</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>Ex3<span class="fl">.2</span><span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Inverse_Transform =</span> X,<span class="at">Acceptance_Rejection =</span> X.ar)</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Ex3<span class="fl">.2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Index&quot;</span>)<span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Inverse_Transform,<span class="at">y =</span> <span class="fu">after_stat</span>(density)),<span class="at">color =</span> <span class="st">&quot;red&quot;</span>,<span class="at">fill =</span> <span class="st">&quot;#FDD7D7&quot;</span>,<span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Acceptance_Rejection,<span class="at">y =</span> <span class="fu">after_stat</span>(density)),<span class="at">color =</span> <span class="st">&quot;green&quot;</span>,<span class="at">fill =</span> <span class="st">&quot;#D6FED6&quot;</span>,<span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> d[<span class="sc">-</span><span class="dv">1</span>],<span class="at">y =</span> <span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="fu">abs</span>(d[<span class="sc">-</span><span class="dv">1</span>]))),<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The <strong>red</strong> color is inverse transform method, The
<strong>green</strong> color is acceptance rejection method, and the
<strong>black</strong> line is the target distribution.</p>
</div>
<div id="exercise-3.7" class="section level3">
<h3>Exercise 3.7</h3>
<p>We take U(0,1) as a suggestive function since beta distribution is
defined in (0,1), and <span class="math inline">\(c=1\)</span>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>my.density.beta<span class="ot">&lt;-</span><span class="cf">function</span>(x,<span class="at">a =</span> <span class="dv">3</span>,<span class="at">b =</span> <span class="dv">2</span>){</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">beta</span>(a,b))</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>}</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>my.AR.beta<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">n =</span> <span class="dv">1000</span>,<span class="at">a =</span> <span class="dv">3</span>,<span class="at">b =</span> <span class="dv">2</span>){</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  count<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  X.beta<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  <span class="fu">set.seed</span>(SEED)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  <span class="cf">while</span>(count <span class="sc">&lt;</span> n){</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>    U<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>    Y<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">my.density.beta</span>(Y) <span class="sc">&gt;</span> U){</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>      count<span class="ot">&lt;-</span>count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>      X.beta[count]<span class="ot">&lt;-</span>Y</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>    }</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>  }</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>  <span class="fu">return</span>(X.beta)</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>}</span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>X.beta<span class="ot">&lt;-</span><span class="fu">my.AR.beta</span>()</span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a><span class="co">#Graph</span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> X.beta,<span class="at">y =</span> <span class="fu">after_stat</span>(density)),<span class="at">color =</span> <span class="st">&quot;red&quot;</span>,<span class="at">fill =</span> <span class="st">&quot;#FDD7D7&quot;</span>)<span class="sc">+</span></span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>),<span class="at">y =</span> <span class="fu">my.density.beta</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>))))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.9" class="section level3">
<h3>Exercise 3.9</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>my.kernel.RN<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">n =</span> <span class="fl">1e4</span>){<span class="co">#Random Number</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(SEED)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  U1<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  U2<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  U3<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  X.kernel<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(U3[i])<span class="sc">&gt;=</span><span class="fu">abs</span>(U2[i]) <span class="sc">&amp;&amp;</span> <span class="fu">abs</span>(U3[i])<span class="sc">&gt;=</span><span class="fu">abs</span>(U1[i])){</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>      X.kernel[i]<span class="ot">&lt;-</span>U2[i]</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>      X.kernel[i]<span class="ot">&lt;-</span>U3[i]</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>    }</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>  }</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>  <span class="fu">return</span>(X.kernel)</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>}</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>X.kernel<span class="ot">&lt;-</span><span class="fu">my.kernel.RN</span>(<span class="fl">1e5</span>)</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="co">#Graph</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> X.kernel,<span class="at">y =</span> <span class="fu">after_stat</span>(density)),<span class="at">color =</span> <span class="st">&quot;green&quot;</span>,<span class="at">fill =</span> <span class="st">&quot;#D6FED6&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.10" class="section level3">
<h3>Exercise 3.10</h3>
<p>Use the variates <em>X.kernel</em> from Exercise 3.9 for proof.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">hist</span>(X.kernel,<span class="at">prob =</span> T)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(X.kernel),<span class="at">col =</span> <span class="st">&quot;red&quot;</span>,<span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>index<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,.<span class="dv">001</span>)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="fu">lines</span>(index,<span class="fl">0.75</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>index<span class="sc">^</span><span class="dv">2</span>),<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The variates generated form Exercise 3.9 are from the density <span class="math inline">\(f_e\)</span> (<span class="math inline">\(\ref{3.10}\)</span>).</p>
</div>
</div>
</div>
<div id="homework-2" class="section level1">
<h1>Homework 2</h1>
<div id="questions-2" class="section level2">
<h2>Questions</h2>
<p><strong>Exercise 1.</strong></p>
<ul>
<li><p>(1). Proof that what value <span class="math inline">\(\rho=\frac{l}{d}\)</span> should take to minimize
the asymptotic variance of <span class="math inline">\(\hat{\pi}\)</span>? (<span class="math inline">\(m
\sim B(n, p)\)</span>, using <span class="math inline">\(\delta\)</span>
method)</p></li>
<li><p>(2). Take three different values of <span class="math inline">\(\rho\)</span> (<span class="math inline">\(0 \le
\rho \le 1\)</span>, including <span class="math inline">\(ρ_{min}\)</span>) and use Monte Carlo simulation
to verify your answer. (<span class="math inline">\(n = 10^6\)</span>,
Number of repeated simulations <span class="math inline">\(K =
100\)</span>)</p></li>
</ul>
<!-- 1.  找一个最优的$\frac l d:=\rho$，使得$$\hat{\pi}=\frac{2l}{d\hat{p}},~~~~\hat{p}=\frac{n}{m}$$的渐近方差最小.($\delta$法，$n\sim B(m,p)$) -->
<!-- 记最优的$\rho$为$\rho_{min}$. -->
<!-- 2.  取三个不同的$\rho(0\le\rho\le1)$，其中一个为$\rho_{min}$. -->
<!-- (1). 如$\rho_{min}=1$，取另两个$\rho$为0.5，0.8. -->
<!-- (2). 如$\rho_{min}<1$，取另两个$\rho$为$\frac\rho2,1$. -->
<!-- 用MC方法比较三个$\rho$之下$\hat\pi$的方差.(取$m=10^4$) -->
<p><strong>Exercise 5.6.</strong> In Example 5.7 the control variate
approach was illustrated for Monte Carlo integration of <span class="math display">\[\theta=\int_{0}^1e^xdx.\]</span> Now consider the
antithetic variate approach. Compute <span class="math inline">\(Cov(e^U
, e^{1−U} )\)</span> and <span class="math inline">\(Var(e^U + e^{1−U}
)\)</span>, where <span class="math inline">\(U \sim\)</span>
Uniform(0,1). What is the percent reduction in variance of <span class="math inline">\(\hat{θ}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
<p><strong>Exercise 5.7.</strong> Refer to Exercise 5.6. Use a Monte
Carlo simulation to estimate <span class="math inline">\(\theta\)</span>
by the antithetic variate approach and by the simple Monte Carlo method.
Compute an empirical estimate of the percent reduction in variance using
the antithetic variate. Compare the result with the theoretical value
from Exercise 5.6.</p>
</div>
<div id="answers-2" class="section level2">
<h2>Answers</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>SEED<span class="ot">&lt;-</span><span class="dv">20230925</span></span></code></pre></div>
<div id="exercise-1-1." class="section level3">
<h3>Exercise 1 (1).</h3>
<p>By the expression of <span class="math inline">\(\hat{\pi}=\frac{2l}{d\hat{p}},\hat{p}=\frac{m}{n},m\sim
B(n,p)\)</span>, we can obtain <span class="math display">\[\hat{\pi}=2\rho\frac{n}{m}.\]</span></p>
<p>According to central limit theorem, <span class="math inline">\(\sqrt{n}(\frac{m}{n}-p)\sim N(0,p(1-p))\)</span>.
Denote <span class="math inline">\(g(x)=\frac{2\rho}{x}\)</span> by
delta method, <span class="math inline">\(g&#39;(x)\)</span> exists and
<span class="math inline">\(g&#39;(p)\ne 0\)</span>, one has <span class="math inline">\(\sqrt{n}(g(\frac{m}{n})-g(p))\sim
N(0,p(1-p)[g&#39;(p)]^2)\)</span>. That is, <span class="math display">\[\sqrt{n}(2\rho\frac{n}{m}-\frac{2\rho}{p})\sim
N(0,\frac{4\rho^2(1-p)}{p^3}).\]</span></p>
<p>Hence, the variance of <span class="math inline">\(\hat\pi\)</span>
is obtained by <span class="math inline">\(p=\frac{2l}{d\pi}=\frac{2\rho}{\pi}\)</span>:
<span class="math display">\[Var(\hat\pi)=\frac{\pi^3}{2n}\frac{1-\frac{2}{\pi}\rho}{\rho},~~~~\rho\in(0,1].\]</span></p>
<p>It is clear that <span class="math inline">\(Var(\hat\pi)=\frac{\pi^3}{2n}(\frac{1}{\rho}-\frac{2}{\pi})\)</span>
is a monotonically decreasing function in <span class="math inline">\((0,1]\)</span>. The asymptotic variance of <span class="math inline">\(\hat\pi\)</span> reaches minimum when <span class="math inline">\(\rho=1\)</span>.</p>
</div>
<div id="exercise-1-2." class="section level3">
<h3>Exercise 1 (2).</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>K<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e6</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="dv">1</span>)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>num<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(s))</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(s)){</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  l<span class="ot">&lt;-</span>s[i]</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>  rho<span class="ot">&lt;-</span>l<span class="sc">/</span>d</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>  pihat<span class="ot">&lt;-</span><span class="fu">numeric</span>(K)</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>    pihat[j] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>rho<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>  }</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>  num[i]<span class="ot">&lt;-</span><span class="fu">var</span>(pihat)</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>}</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">t</span>(num))</span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="fu">colnames</span>(data)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&#39;rho=0.5&#39;</span>,<span class="st">&#39;rho=0.8&#39;</span>,<span class="st">&#39;rho=1&#39;</span>)</span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>, <span class="at">digits =</span> <span class="dv">8</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">rho=0.5</th>
<th align="center">rho=0.8</th>
<th align="center">rho=1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">2.195e-05</td>
<td align="center">9.89e-06</td>
<td align="center">5.58e-06</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">barplot</span>(num,<span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">&#39;rho=0.5&#39;</span>,<span class="st">&#39;rho=0.8&#39;</span>,<span class="st">&#39;rho=1&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmkJBmtv+QOgCQkGaQ2/+2ZgC2/7a2//++vr7bkDrb////tmb/25D//7b//9v///+RqlVXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFJUlEQVR4nO3d7XbSQBgA4dS2atFWUCmluf/7NB/QAmUzYdmtkJ354VGPvmkfl5AQDFVtg1X/+wu49ASCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCsgBVp5XjS0hWHqC/pySQQB+GCgRDBYKhAsFQgWCoQDC0UKD17KH5cdUc2n35Mzy0ZKDl7XP7s8f9KftHxSUDbWg6puC4koFe7jugVeBBJpAraKD1rN3L3NXb3XVwXKlAdWd0M2+eyAI+Ao0bJxCMKxfo9ak/2gkeKBYOtNzue4I7obKBXp/eWHyaP9bOCYYHisdyBVHLarOE3AcF6o+lqyqwfgQaOa5woJ1dUWCcQDBOIBgnEIwTCMYVDsTjigZqDoVunxe+YBZqdTNvTjN8yTVUu/9pz8OWnqwerz2hb4EOzua9cLhtu4IWns0H6vdBb6f1x8eVDNSf0N/MB8cVDTRmnEAwrlSgEe8PEuj4+4MOxpUM5Ls7BvL9QZArCPL9QZzvD0oyTiAYJ5CvB503TiAYJxCMEwjGCQTjSgXavjto4H2uZQPVr0/wH8VKB2qE7saMKxeoOQsLvFK2N65goNAULxyeNC4W6BJvinJZQJF/L2cCjfqOEo8TCMYJBOMEgnECwTiBYJxAME4gGCcQjBMIxgkE4wSCcQLBOIFgnEAwTiAYJxCMEwjGlQuU+f5BkX8v62v9J/3x3PcPigWK3FxyoOx3f7l2oPD9gxJdOLx2IFcQlfv+QVcPlPv+QdcPNHKcQDCuXKALPVCM3Fx6IA8Uh/NpHsp+o8lrB3IFUR4oUh4onptAo8aVDRR6AtsZJxCMEwjGFQy07J/FMt1gaQJAtSsIEwgS6JwEGjWuaKCcN7udAtDxm90eXjiMvFge+fdiN5cDiG52O71OBArc7HbCRa6g0M1up1fcPih4s9vpFfMsNnAuNr0SHwdNL4GgxJeep1fiS8/TK/GFw+mV+NLz9HIFQYkvPU+vxJeep5fHQZBAUCSQrwfZJoEggSBPViFPViFPNSBPVqE8Kyj44Uh19+lSby9pv3+USYqGtlrXL9+i/k3znKwOfKmr9oNLtkIvX1O++j8ItJ7FLfo8J6vhL7VfhYvNokn7SIV1+xlAI1r/+FV9+T37eV91y639uLbd1dZ/utT2TGWZ7NE1vNV2yUf+Y6QHmjXLaz1rHkTL7lOAHptf3DUu3cq7mfcPqu0Xu/h++J3k2WpdR6/WDEAPmx+axdI/oFY71xn7n29+p/u26uB7adJttdvyxQA9vv/QP6A2H9rWtQe0+a0EOyLY6hmb+Qyg3Z3n/kOs/6378y/0w1brw22O75NW0Ps+aG8n3ZXiuR622v6RiwT6uDfYe5rvv5PkD7Er2ge9PZ+8t3eg2EGl2UkPb7W+VKCPRyTt/2ZoffqP6FhUVZK3GuFWLwdoagkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQT9A8pRuqmk0b/OAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="exercise-5.6." class="section level3">
<h3>Exercise 5.6.</h3>
<p>According to the definition of covariance and variance, we obtain</p>
<span class="math display">\[\begin{aligned}
Cov(e^U,e^{1-U}) &amp; = E(e^U\times e^{1-U})-E(e^U)\times E(e^{1-U}) \\
&amp; = e-\int_{0}^{1}e^xdx\times\int_0^1e^{1-x}dx \\
&amp; = e-(e-1)^2 \\
&amp; = -e^2+3e-1
\end{aligned}\]</span>
<p>and</p>
<span class="math display">\[\begin{aligned}
Var(e^U+e^{1-U}) &amp; = Var(e^U) + Var(e^{1-U}) + 2Cov(e^U,e^{1-U}) \\
&amp; = E(e^{2U})-(E(e^U))^2+E(e^{2(1-U)})-(E(e^{1-U}))^2 - 2e^2+6e-2 \\
&amp; = e^2-1-2(e-1)^2-2e^2+6e-2 \\
&amp; = -3e^2+10e-5.
\end{aligned}\]</span>
<p>So the covariance <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> is -0.234211 and the
variance <span class="math inline">\(Var_{ant}:=Var(e^U+e^{1-U})\)</span> is
0.01565.</p>
<p>By the simple MC, the variance is</p>
<span class="math display">\[\begin{aligned}
Var(e^U) &amp; = E(e^{2U})-(E(e^U))^2 \\
&amp; = \frac{1}{2}(e^2-1)-(e-1)^2 \\
&amp; = -\frac{1}{2}(e^2-4e+3).
\end{aligned}\]</span>
<p>That is, <span class="math inline">\(Var_{sim}:=Var(e^U)=\)</span>
0.242036. The percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates is <span class="math display">\[\frac{Var_{sim}-Var_{ant}}{Var_{sim}}=\frac{-\frac12(e^2-4e+3)-\frac14(-3e^2+10e-5)}{-\frac12(e^2-4e+3)}=\frac{e^2-2e-1}{-2e^2+8e-6}=0.983835.\]</span></p>
</div>
<div id="exercise-5.7." class="section level3">
<h3>Exercise 5.7.</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>MCInt<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">n =</span> <span class="fl">1e4</span>,<span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;simple&quot;</span>,<span class="st">&quot;antithetic&quot;</span>),<span class="at">seed =</span> <span class="dv">20230925</span>){</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  <span class="cf">if</span>(method <span class="sc">==</span> <span class="st">&quot;simple&quot;</span>){</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed)</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>    U<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>    theta<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">exp</span>(U))</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>    <span class="fu">return</span>(theta)</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(method <span class="sc">==</span> <span class="st">&quot;antithetic&quot;</span>){</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed)</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>    U<span class="ot">&lt;-</span><span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>    theta<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">exp</span>(U)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>    <span class="fu">return</span>(theta)</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>  }<span class="cf">else</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;Wrong method!&quot;</span>)</span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>}</span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="co"># simple MC vs antithetic variate</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> theta2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a>  theta1[i]<span class="ot">&lt;-</span><span class="fu">MCInt</span>(<span class="at">method =</span> <span class="st">&quot;simple&quot;</span>,<span class="at">seed =</span> SEED<span class="sc">+</span>i)</span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a>  theta2[i]<span class="ot">&lt;-</span><span class="fu">MCInt</span>(<span class="at">method =</span> <span class="st">&quot;antithetic&quot;</span>,<span class="at">seed =</span> SEED<span class="sc">+</span>i)</span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a>}</span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a><span class="fu">var</span>(theta1)</span></code></pre></div>
<pre><code>## [1] 2.42272e-05</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">var</span>(theta2)</span></code></pre></div>
<pre><code>## [1] 7.767914e-07</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>(<span class="fu">var</span>(theta1)<span class="sc">-</span><span class="fu">var</span>(theta2))<span class="sc">/</span><span class="fu">var</span>(theta1)</span></code></pre></div>
<pre><code>## [1] 0.9679372</code></pre>
<p>The percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> by simulation that can be
achieved using antithetic variates is 0.967937. And the theoretical
value is 0.983835</p>
</div>
</div>
</div>
<div id="homework-3" class="section level1">
<h1>Homework 3</h1>
<div id="questions-3" class="section level2">
<h2>Questions</h2>
<div id="exercise-1." class="section level3">
<h3>Exercise 1.</h3>
<p><span class="math inline">\(Var(\hat{\theta}^M)=\frac{1}{Mk}\sum_{i=1}^{k}\sigma_i^2+Var(\theta_I)=Var(\hat{\theta}^S)+Var(\theta_I)\)</span>,
where <span class="math inline">\(\theta_i=E[g(U)|I=i]\)</span>, <span class="math inline">\(\sigma_i^2=Var[g(U)|I=i]\)</span> and <span class="math inline">\(I\)</span> takes uniform distribution over <span class="math inline">\(\{1,\cdots,k\}\)</span>.</p>
<p>Proof that if <span class="math inline">\(g\)</span> is a continuous
function over <span class="math inline">\((a,b)\)</span>, then <span class="math inline">\(Var(\hat\theta^M)\rightarrow 0\)</span> as <span class="math inline">\(b_i-a_i\rightarrow 0\)</span> for all <span class="math inline">\(i=1,\cdots,k\)</span>.</p>
</div>
<div id="exercise-5.13." class="section level3">
<h3>Exercise 5.13.</h3>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},~~~~x&gt;1.\]</span>
Which of your two importance functions should produce the smaller
variance in estimating <span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span>
by importance sampling? Explain.</p>
</div>
<div id="exercise-5.14." class="section level3">
<h3>Exercise 5.14.</h3>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span>
by importance sampling.</p>
</div>
<div id="exercise-5.15." class="section level3">
<h3>Exercise 5.15.</h3>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
</div>
<div id="exercise-6.5." class="section level3">
<h3>Exercise 6.5.</h3>
<p>Suppose a 95% symmetric <span class="math inline">\(t\)</span>-interval is applied to estimate a mean,
but the sample data are non-normal. Then the probability that the
confidence interval covers the mean is not necessarily equal to 0.95.
Use a Monte Carlo experiment to estimate the coverage probability of the
<span class="math inline">\(t\)</span>-interval for random samples of
<span class="math inline">\(\chi^2(2)\)</span> data with sample size
<span class="math inline">\(n = 20\)</span>. Compare your <span class="math inline">\(t\)</span>-interval results with the simulation
results in Example 6.4. (The <span class="math inline">\(t\)</span>-interval should be more robust to
departures from normality than the interval for variance.)</p>
</div>
<div id="exercise-6.a." class="section level3">
<h3>Exercise 6.A.</h3>
<p>Use Monte Carlo simulation to investigate whether the empirical Type
I error rate of the <span class="math inline">\(t\)</span>-test is
approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is
non-normal. The <span class="math inline">\(t\)</span>-test is robust to
mild departures from normality. Discuss the simulation results for the
cases where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii)
Exponential(rate=1). In each case, test <span class="math inline">\(H_0
: \mu = \mu_0\)</span> vs <span class="math inline">\(H_0 :
\mu\ne\mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span>
is the mean of <span class="math inline">\(\chi^2(1)\)</span>,
Uniform(0,2), and Exponential(1), respectively.</p>
</div>
</div>
<div id="answers-3" class="section level2">
<h2>Answers</h2>
<div id="exercise-1.-1" class="section level3">
<h3>Exercise 1.</h3>
<p>It is known that <span class="math inline">\(Var(\hat\theta^M)=Var(\hat\theta^S)+\frac1MVar(\theta_I)\)</span>,
we need to prove <span class="math inline">\(\frac{Var(\hat\theta^S)}{Var(\hat\theta^M)}\rightarrow
0\)</span> as <span class="math inline">\(b_i-a_i\rightarrow 0\)</span>
when <span class="math inline">\(g\)</span> is a continuous function,
<span class="math inline">\(i=1,\cdots,k\)</span>.</p>
<p>We first prove <span class="math inline">\(Var(\hat\theta^S)\rightarrow 0\)</span> and then
prove <span class="math inline">\(Var(\hat\theta^M)&gt;0\)</span>.</p>
<p>According to the stratified sampling, <span class="math inline">\(\hat\theta^S=\frac1k\sum_{i=1}^k\hat\theta_i\)</span>,
its variance is <span class="math inline">\(Var(\hat\theta^S)=\frac{1}{k^2}\sum_{i=1}^kVar(\hat\theta_i)\)</span>,
where <span class="math inline">\(Var(\hat\theta_i)=E(\hat\theta_i-\theta_i)^2\)</span>.</p>
<span class="math inline">\(U\)</span> is a uniform random variable on
<span class="math inline">\((a_i,b_i)\)</span>. When <span class="math inline">\(b_i-a_i\rightarrow 0\)</span>, <span class="math inline">\(U\rightarrow a_i\)</span> due to squeeze theorem.
Since <span class="math inline">\(g\)</span> is a continuous function,
<span class="math inline">\(g(U)\rightarrow g(a_i)\)</span>. Hence, we
obtain <span class="math inline">\(\hat\theta_i=\frac1r\sum_{i=1}^rg(U|I=i)\rightarrow
g(a_i)\)</span> and
<span class="math display">\[\begin{aligned}
\theta_i &amp; = E(g(U)|I=i) \\
&amp; = \int_{a_i}^{b_i}g(U|I=i)\frac{1}{b_i-a_i}dU \\
&amp; =
\int_{a_i}^{a_i+\varepsilon}g(U|I=i)\frac{1}{\varepsilon}dU,~~~~\varepsilon\rightarrow
0 \\
&amp; = g(\xi)\frac{1}{\varepsilon}\varepsilon,~~~~\xi\in
(a_i,a_i+\varepsilon), \varepsilon\rightarrow 0 \\
&amp; =
g(a_i).~~~~(\mathrm{by~mean~value~theorems~for~definite~integrals})
\end{aligned}\]</span>
<p>That is, <span class="math display">\[Var(\hat\theta^S)=\frac{1}{k^2}\sum_{i=1}^kVar(\hat\theta_i)=\frac{1}{k^2}\sum_{i=1}^kE(\hat\theta_i-\theta_i)^2\rightarrow
0.\]</span></p>
Next, we will prove <span class="math inline">\(Var(\theta_I)\ge
0\)</span>, which can derive <span class="math inline">\(Var(\hat\theta^M)&gt;0\)</span> is hold. It is
clear that <span class="math inline">\(Var(\theta_I)=E(\theta_I^2)-(E\theta_I)^2\)</span>
and <span class="math display">\[E\theta_I=\frac1k\sum_{i=1}^k\theta_i=\frac1k\sum_{i=1}^kg(a_i),\]</span>
<span class="math display">\[E(\theta_I^2)=\frac1k\sum_{i=1}^k\theta_i^2=\frac1k\sum_{i=1}^kg^2(a_i).\]</span>
Hence, we have
<span class="math display">\[\begin{aligned}
Var(\theta_I) &amp; = E(\theta_I^2)-(E\theta_I)^2 \\
&amp; =
\frac{1}{k^2}\left[k\sum_{i=1}^kg^2(a_i)-\left(\sum_{i=1}^kg(a_i)\right)^2\right]
\\
&amp; =
\frac{1}{k^2}\left[(1^2+\cdots+1^2)(g^2(a_1)+\cdots+g^2(a_k))-\left(\sum_{i=1}^kg(a_i)\right)^2\right]
\\
&amp; \ge
\frac{1}{k^2}\left[\left(\sum_{i=1}^kg(a_i)\right)^2-\left(\sum_{i=1}^kg(a_i)\right)^2\right]~~~~(\mathrm{by~Cauchy-Schwarz~inequality})
\\
&amp; = 0.
\end{aligned}\]</span>
<p>Through the above derivation, we get the conclusion <span class="math inline">\(\frac{Var(\hat\theta^S)}{Var(\hat\theta^M)}\rightarrow
0\)</span> as <span class="math inline">\(b_i-a_i\rightarrow
0\)</span>.</p>
</div>
<div id="exercise-5.13.-1" class="section level3">
<h3>Exercise 5.13.</h3>
<p>By the importance sampling, we obtain <span class="math display">\[\int_1^\infty g(x)dx=\int_1^\infty
\frac{g(x)}{f(x)}f(x)dx=E(\frac{g(x)}{f(x)}).\]</span> That is, <span class="math inline">\(\hat{\theta}=\frac{1}{m}\sum_{i=1}^{m}\frac{g(X_i)}{f(X_i)}\)</span>,
and <span class="math inline">\(Var(\hat\theta)=\frac{1}{m}Var(\frac{g(X)}{f(X)})\)</span>
for <span class="math inline">\(X\sim f\)</span>.</p>
<p>Suppose the function <span class="math inline">\(f_1(x)\)</span> and
<span class="math inline">\(f_2(x)\)</span> are <span class="math display">\[f_1(x)=\frac{1}{\sqrt{2\pi}}e^{-\frac{(x-1)^2}{2}},~~~~x\sim
N(1,1)\]</span> and</p>
<p><span class="math display">\[f_2(x)=4xe^{-2x},~~~~x\sim\Gamma(2,2).\]</span>
The curves of <span class="math inline">\(g(x), f_1(x), f_2(x)\)</span>
is drawn below.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,.<span class="dv">01</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  gx<span class="ot">&lt;-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>  <span class="fu">return</span>(gx)</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>}</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>  f1x<span class="ot">&lt;-</span><span class="fu">dnorm</span>(x,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>  <span class="fu">return</span>(f1x)</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>}</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  f2x<span class="ot">&lt;-</span><span class="fu">dgamma</span>(x,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>  <span class="fu">return</span>(f2x)</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>}</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>lg<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span>,<span class="st">&quot;f1(x)&quot;</span>,<span class="st">&quot;f2(x)&quot;</span>)</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">g</span>(x),<span class="at">lty =</span> <span class="dv">1</span>,<span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="st">&quot;red&quot;</span>,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>),<span class="at">ylab =</span> <span class="st">&quot;density&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Figure 1&quot;</span>)</span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">f1</span>(x),<span class="at">lty =</span> <span class="dv">2</span>,<span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">f2</span>(x),<span class="at">lty =</span> <span class="dv">3</span>,<span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend =</span> lg,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>),<span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
Now we will calculate the variance of the importance sampling. Denote
<span class="math inline">\(\theta=\int_1^\infty
g(x)dx=E(\frac{g(x)}{f(x)}).\)</span>
<span class="math display">\[\begin{aligned}
Var(\hat\theta) &amp; =
\frac{1}{n}Var\left(\frac{g(X)}{f(X)}\right),~~X\sim f(X) \\
&amp; =
\frac{1}{n}\left[\int_1^\infty\frac{g^2(x)}{f(x)}dx-\theta^2\right].
\end{aligned}\]</span>
<p>The variance of <span class="math inline">\(\hat\theta\)</span>
reaches minimum when <span class="math display">\[f(x) =
\frac{|g(x)|}{\int_1^\infty |g(x)|dx}.\]</span> Hence, selecting <span class="math inline">\(f(x)\)</span> which has a similar shape to <span class="math inline">\(|g(x)|\)</span> can help reduce the variance of
<span class="math inline">\(\hat\theta\)</span>. <span class="math inline">\(f_1(x)\)</span> has a similar shape to <span class="math inline">\(|g(x)|\)</span> from Figure 1, so we think the
importance function <span class="math inline">\(f_1(x)\)</span> has the
smaller variance.</p>
</div>
<div id="exercise-5.14.-1" class="section level3">
<h3>Exercise 5.14.</h3>
<p>Set <span class="math inline">\(f(x)=\frac{1}{\sqrt{2\pi}}e^{-\frac{(x-1)^2}{2}}\)</span>,
<span class="math inline">\(\hat\theta\)</span> and its variance can be
obtained by importance sampling.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>  gx<span class="ot">&lt;-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  <span class="fu">return</span>(gx)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>}</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e6</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>SEED<span class="ot">&lt;-</span><span class="dv">20231009</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>gf<span class="ot">&lt;-</span><span class="fu">g</span>(u)<span class="sc">/</span><span class="fu">dnorm</span>(u,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>ghat<span class="ot">&lt;-</span><span class="fu">mean</span>(gf)</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>Var<span class="ot">&lt;-</span><span class="fu">var</span>(gf)</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The estimate of theta is&quot;</span>,<span class="fu">round</span>(ghat,<span class="dv">6</span>),<span class="st">&quot;and its variance is&quot;</span>,<span class="fu">round</span>(Var,<span class="dv">6</span>))</span></code></pre></div>
<pre><code>## The estimate of theta is 0.400689 and its variance is 0.16442</code></pre>
</div>
<div id="exercise-5.15.-1" class="section level3">
<h3>Exercise 5.15.</h3>
<p>To calculate the value of <span class="math display">\[\int_0^1\frac{e^{-x}}{1+x^2}dx:=\int_0^1g(x)dx,\]</span>
stratified importance sampling is applied, and the result will be
compared with that of stratified sampling method.</p>
<p>According to the stratified importance sampling, we obtain</p>
<span class="math display">\[\begin{aligned}
  \int_0^1g(x)dx &amp; =
\sum_{j=1}^{5}\int_{\frac{j-1}{5}}^{\frac{j}{5}}\frac{g(x)}{f(x)}f(x)dx
\\
  &amp; =  \sum_{j=1}^{5}E\left(\frac{g(x)}{f(x)}\right),~~~~x\sim f(x).
\end{aligned}\]</span>
<p>Denote <span class="math inline">\(f(x)=C\times e^{-x}\)</span>,
where <span class="math inline">\(C\)</span> is a constant so that <span class="math inline">\(\int_{(j-1)/5}^{j/5}f(x)dx=1\)</span>. That is,
<span class="math inline">\(f(x)=\frac{e^{-x}}{e^{-\frac{j-1}{5}}-e^{-\frac{j}{5}}}\)</span>,
where <span class="math inline">\(\frac{j-1}{5}\le x
&lt;\frac{j}{5}\)</span> and <span class="math inline">\(j=1,2,3,4,5\)</span>.</p>
<p>Next, inverse transform method will be applied to generate random
numbers obeying <span class="math inline">\(f(x)\)</span>. The cdf of
<span class="math inline">\(f(x)\)</span> is <span class="math display">\[F(x)=\int_{\frac{j-1}{5}}^xf(x)dx=\frac{e^{-\frac{j-1}{5}}-e^{-x}}{e^{-\frac{j-1}{5}}-e^{-\frac{j}{5}}},~~~~\frac{j-1}{5}\le
x&lt;\frac{j}{5}.\]</span> The random number <span class="math inline">\(x:=-\log(e^{\frac{j-1}{5}}-(e^{-\frac{j-1}{5}}-e^{-\frac{j}{5}})\times
U)\sim f(x)\)</span> using inverse transform method, where <span class="math inline">\(U\sim\)</span> Uniform(0,1).</p>
<p>The values and standard errors of <span class="math inline">\(\int_0^1g(x)dx\)</span> can be calculated by
stratified importance sampling and stratified sampling, which is listed
below.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x){ <span class="co">#for stratified sampling</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>))</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>}</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>g_si<span class="ot">&lt;-</span><span class="cf">function</span>(x,j){ <span class="co">#for stratified importance sampling</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span>j<span class="sc">/</span><span class="dv">5</span>))</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>}</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x,j){</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>j<span class="sc">/</span><span class="dv">5</span>)))</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>}</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>stra_sampling<span class="ot">&lt;-</span><span class="cf">function</span>(r,j,k){</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">g</span>(<span class="fu">runif</span>(r,(j<span class="dv">-1</span>)<span class="sc">/</span>k,j<span class="sc">/</span>k))))</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>}</span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>stra_im_sampling<span class="ot">&lt;-</span><span class="cf">function</span>(r,j){</span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(r)</span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span>(<span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>j<span class="sc">/</span><span class="dv">5</span>))<span class="sc">*</span>u)</span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">g_si</span>(u,j)<span class="sc">/</span><span class="fu">f</span>(u,j)))</span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a>}</span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>data_print<span class="ot">&lt;-</span><span class="cf">function</span>(est){</span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(est[,<span class="dv">1</span>]),<span class="fu">mean</span>(est[,<span class="dv">2</span>]),<span class="fu">sd</span>(est[,<span class="dv">1</span>]),<span class="fu">sd</span>(est[,<span class="dv">2</span>])),<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">byrow =</span> T))</span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a>  <span class="fu">colnames</span>(d)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Stratified sampling&quot;</span>,<span class="st">&quot;Stratified importance sampling&quot;</span>)</span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a>  <span class="fu">rownames</span>(d)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;theta_hat&quot;</span>,<span class="st">&quot;sd&quot;</span>)</span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a>  <span class="fu">kable</span>(d,<span class="at">align =</span> <span class="st">&quot;ccc&quot;</span>)</span>
<span id="cb34-25"><a href="#cb34-25" tabindex="-1"></a>}</span>
<span id="cb34-26"><a href="#cb34-26" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb34-27"><a href="#cb34-27" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb34-28"><a href="#cb34-28" tabindex="-1"></a>r<span class="ot">&lt;-</span>M<span class="sc">/</span>k</span>
<span id="cb34-29"><a href="#cb34-29" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb34-30"><a href="#cb34-30" tabindex="-1"></a>Theta1<span class="ot">&lt;-</span>Theta2<span class="ot">&lt;-</span><span class="fu">numeric</span>(k)</span>
<span id="cb34-31"><a href="#cb34-31" tabindex="-1"></a>est<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb34-32"><a href="#cb34-32" tabindex="-1"></a>SEED<span class="ot">&lt;-</span><span class="dv">20231009</span></span>
<span id="cb34-33"><a href="#cb34-33" tabindex="-1"></a><span class="fu">set.seed</span>(SEED)</span>
<span id="cb34-34"><a href="#cb34-34" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb34-35"><a href="#cb34-35" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb34-36"><a href="#cb34-36" tabindex="-1"></a>    Theta1[j]<span class="ot">&lt;-</span><span class="fu">stra_sampling</span>(r,j,k)</span>
<span id="cb34-37"><a href="#cb34-37" tabindex="-1"></a>    Theta2[j]<span class="ot">&lt;-</span><span class="fu">stra_im_sampling</span>(r,j)</span>
<span id="cb34-38"><a href="#cb34-38" tabindex="-1"></a>  }</span>
<span id="cb34-39"><a href="#cb34-39" tabindex="-1"></a>  est[i,]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(Theta1),<span class="fu">sum</span>(Theta2))</span>
<span id="cb34-40"><a href="#cb34-40" tabindex="-1"></a>}</span>
<span id="cb34-41"><a href="#cb34-41" tabindex="-1"></a><span class="fu">data_print</span>(est)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Stratified sampling</th>
<th align="center">Stratified importance sampling</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">theta_hat</td>
<td align="center">0.5245868</td>
<td align="center">0.5247630</td>
</tr>
<tr class="even">
<td align="left">sd</td>
<td align="center">0.0015189</td>
<td align="center">0.0005022</td>
</tr>
</tbody>
</table>
<p>Compared with Example 5.10, the standard deviation of the stratified
importance sampling method is much smaller.</p>
</div>
<div id="exercise-6.5.-1" class="section level3">
<h3>Exercise 6.5.</h3>
<p><span class="math inline">\(X_1,\cdots,X_n\sim\chi^2(2),
n=20\)</span>, then a 95% symmetric <span class="math inline">\(t-\)</span>interval is applied to estimate the
mean <span class="math inline">\(E(X)=2\)</span>. The CI of symmetric
<span class="math inline">\(t-\)</span>interval is <span class="math display">\[(\bar{X}+t_{\alpha/2}(n-1)\sqrt{Var(\bar{X})/n},\bar{X}+t_{1-\alpha/2}(n-1)\sqrt{Var(\bar{X})/n})\tag{*}\label{*}.\]</span>
Denote the counts <span class="math inline">\(EX\in\eqref{*}\)</span> by
<span class="math inline">\(count\)</span>, and the simulation times
<span class="math inline">\(iter\)</span>. The CP is calculated by <span class="math inline">\(CP = \frac{count}{iter}\)</span>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>iter<span class="ot">&lt;-</span><span class="fl">1e5</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>count<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>SEED<span class="ot">&lt;-</span><span class="dv">20231009</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a><span class="fu">set.seed</span>(SEED)</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>sample_generate<span class="ot">&lt;-</span><span class="cf">function</span>(n,df){</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,df)</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>  sample_mean<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>  se<span class="ot">&lt;-</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(sample_mean,se))</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>}</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>in_bound<span class="ot">&lt;-</span><span class="cf">function</span>(n,df,true_mean,<span class="at">alpha =</span> <span class="fl">0.05</span>){</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a>  sample<span class="ot">&lt;-</span><span class="fu">sample_generate</span>(n,df)</span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>  sample_mean<span class="ot">&lt;-</span>sample[<span class="dv">1</span>]</span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>  se<span class="ot">&lt;-</span>sample[<span class="dv">2</span>]</span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>  lower_bound<span class="ot">&lt;-</span>sample_mean<span class="sc">+</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">*</span>se</span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a>  upper_bound<span class="ot">&lt;-</span>sample_mean<span class="sc">+</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">*</span>se</span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a>  <span class="cf">if</span>(lower_bound<span class="sc">&lt;</span>true_mean <span class="sc">&amp;</span> upper_bound<span class="sc">&gt;</span>true_mean) <span class="fu">return</span>(<span class="dv">1</span>)</span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a>}</span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter){</span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a>  count<span class="ot">&lt;-</span>count<span class="sc">+</span><span class="fu">in_bound</span>(n,<span class="at">df =</span> <span class="dv">2</span>,<span class="at">true_mean =</span> <span class="dv">2</span>)</span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a>}</span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a>count<span class="sc">/</span>iter</span></code></pre></div>
<pre><code>## [1] 0.91967</code></pre>
<p>In Example 6.4, CI for variance is used and <span class="math inline">\(V=\frac{(n-1)S^2}{\sigma^2}\sim
\chi^2(n-1)\)</span>, where <span class="math inline">\(S^2\)</span> is
sample variance. The CI is <span class="math inline">\((0,\frac{(n-1)S^2}{\chi^2_{\alpha}(n-1)})\)</span>.
The calculation of CP is same as <span class="math inline">\(\eqref{*}\)</span>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a><span class="co"># Example 6.4</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>iter<span class="ot">&lt;-</span><span class="fl">1e5</span></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>count<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>SEED<span class="ot">&lt;-</span><span class="dv">20231009</span></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a><span class="fu">set.seed</span>(SEED)</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>sample_generate<span class="ot">&lt;-</span><span class="cf">function</span>(n,df){</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,df)</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>}</span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>in_bound<span class="ot">&lt;-</span><span class="cf">function</span>(n,df,<span class="at">alpha =</span> <span class="fl">0.05</span>){</span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">sample_generate</span>(n,df)</span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>  upper_bound<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">qchisq</span>(alpha, <span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a>  <span class="cf">if</span>(upper_bound<span class="sc">&gt;</span>df<span class="sc">^</span><span class="dv">2</span>) <span class="fu">return</span>(<span class="dv">1</span>)</span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a>}</span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter){</span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a>  count<span class="ot">&lt;-</span>count<span class="sc">+</span><span class="fu">in_bound</span>(n,<span class="dv">2</span>)</span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a>}</span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a>count<span class="sc">/</span>iter</span></code></pre></div>
<pre><code>## [1] 0.78539</code></pre>
<p>The <span class="math inline">\(t\)</span>-interval is more robust to
departures from normality than the interval for variance.</p>
</div>
<div id="exercise-6.a.-1" class="section level3">
<h3>Exercise 6.A.</h3>
<ul>
<li>(i). For the sampled population is <span class="math inline">\(\chi^2(1)\)</span>.</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span> <span class="co"># nominal significance level</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>mu0<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co"># sample true mean</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">30</span> <span class="co"># sample size</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>iter<span class="ot">&lt;-</span><span class="fl">1e5</span> <span class="co"># total iterations</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>t1e<span class="ot">&lt;-</span><span class="dv">0</span> <span class="co"># type 1 error counts</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>SEED<span class="ot">&lt;-</span><span class="dv">20231009</span></span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a><span class="fu">set.seed</span>(SEED)</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>sample_generate<span class="ot">&lt;-</span><span class="cf">function</span>(n,df){</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rchisq</span>(n,df))</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>}</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>in_bound<span class="ot">&lt;-</span><span class="cf">function</span>(n,df,mu0,alpha){</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>  sample<span class="ot">&lt;-</span><span class="fu">sample_generate</span>(n,df)</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>  t_stat<span class="ot">&lt;-</span>(<span class="fu">mean</span>(sample)<span class="sc">-</span>mu0)<span class="sc">/</span>(<span class="fu">sd</span>(sample)<span class="sc">/</span><span class="fu">sqrt</span>(n)) </span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">abs</span>(t_stat)<span class="sc">&gt;</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df =</span> n<span class="dv">-1</span>)) <span class="fu">return</span>(<span class="dv">1</span>)</span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>}</span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter){</span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a>    t1e<span class="ot">&lt;-</span>t1e<span class="sc">+</span><span class="fu">in_bound</span>(n,<span class="at">df =</span> <span class="dv">1</span>,mu0,alpha)</span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a>}</span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a>Et1e<span class="ot">&lt;-</span>t1e<span class="sc">/</span>iter</span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Empirical Type I error rate is:&quot;</span>, Et1e)</span></code></pre></div>
<pre><code>## Empirical Type I error rate is: 0.09224</code></pre>
<ul>
<li>(ii). For the sampled population is Uniform(0,2).</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span> <span class="co"># nominal significance level</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>mu0<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co"># sample true mean</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">30</span> <span class="co"># sample size</span></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>iter<span class="ot">&lt;-</span><span class="fl">1e5</span> <span class="co"># total iterations</span></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>t1e<span class="ot">&lt;-</span><span class="dv">0</span> <span class="co"># type 1 error counts</span></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>SEED<span class="ot">&lt;-</span><span class="dv">20231009</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a><span class="fu">set.seed</span>(SEED)</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>sample_generate<span class="ot">&lt;-</span><span class="cf">function</span>(n,min,max){</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">runif</span>(n,min,max))</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>}</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>in_bound<span class="ot">&lt;-</span><span class="cf">function</span>(n,min,max,mu0,alpha){</span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>  sample<span class="ot">&lt;-</span><span class="fu">sample_generate</span>(n,min,max)</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>  t_stat<span class="ot">&lt;-</span>(<span class="fu">mean</span>(sample)<span class="sc">-</span>mu0)<span class="sc">/</span>(<span class="fu">sd</span>(sample)<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">abs</span>(t_stat)<span class="sc">&gt;</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df =</span> n<span class="dv">-1</span>)) <span class="fu">return</span>(<span class="dv">1</span>)</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a>}</span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter){</span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a>    t1e<span class="ot">&lt;-</span>t1e<span class="sc">+</span><span class="fu">in_bound</span>(n,<span class="at">min =</span> <span class="dv">0</span>,<span class="at">max =</span> <span class="dv">2</span>,mu0,alpha)</span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a>}</span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a>Et1e<span class="ot">&lt;-</span>t1e<span class="sc">/</span>iter</span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Empirical Type I error rate is:&quot;</span>, Et1e)</span></code></pre></div>
<pre><code>## Empirical Type I error rate is: 0.05133</code></pre>
<ul>
<li>(iii). For the sampled population is Exponential (rate=1).</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span> <span class="co"># nominal significance level</span></span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>mu0<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co"># sample true mean</span></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">30</span> <span class="co"># sample size</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>iter<span class="ot">&lt;-</span><span class="fl">1e5</span> <span class="co"># total iterations</span></span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>t1e<span class="ot">&lt;-</span><span class="dv">0</span> <span class="co"># type 1 error counts</span></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>SEED<span class="ot">&lt;-</span><span class="dv">20231009</span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a><span class="fu">set.seed</span>(SEED)</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>sample_generate<span class="ot">&lt;-</span><span class="cf">function</span>(n,rate){</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rexp</span>(n,rate))</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>}</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>in_bound<span class="ot">&lt;-</span><span class="cf">function</span>(n,rate,mu0,alpha){</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>  sample<span class="ot">&lt;-</span><span class="fu">sample_generate</span>(n,rate)</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>  t_stat<span class="ot">&lt;-</span>(<span class="fu">mean</span>(sample)<span class="sc">-</span>mu0)<span class="sc">/</span>(<span class="fu">sd</span>(sample)<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">abs</span>(t_stat)<span class="sc">&gt;</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df =</span> n<span class="dv">-1</span>)) <span class="fu">return</span>(<span class="dv">1</span>)</span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a>}</span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter){</span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a>    t1e<span class="ot">&lt;-</span>t1e<span class="sc">+</span><span class="fu">in_bound</span>(n,<span class="at">rate =</span> <span class="dv">1</span>,mu0,alpha)</span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a>}</span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a>Et1e<span class="ot">&lt;-</span>t1e<span class="sc">/</span>iter</span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Empirical Type I error rate is:&quot;</span>, Et1e)</span></code></pre></div>
<pre><code>## Empirical Type I error rate is: 0.0733</code></pre>
</div>
</div>
</div>
<div id="homework-4" class="section level1">
<h1>Homework 4</h1>
<div id="questions-4" class="section level2">
<h2>Questions</h2>
<div id="exercise-1.-2" class="section level3">
<h3>Exercise 1.</h3>
<p>考虑<span class="math inline">\(m=1000\)</span>个假设，其中前95%个原假设成立，后5%个对立假设成立。在原假设之下，<span class="math inline">\(p\)</span>值服从U(0,1)分布，在对立假设之下，<span class="math inline">\(p\)</span>值服从Beta(0.1,1)分布(可用rbeta生成)。应用Bonferroni校正与B-H校正应用于生成的<span class="math inline">\(m\)</span>个<span class="math inline">\(p\)</span>值(独立)(应用p.adjust)，得到校正后的<span class="math inline">\(p\)</span>值，与<span class="math inline">\(\alpha=0.1\)</span>比较确定是否拒绝原假设。基于<span class="math inline">\(M=1000\)</span>次模拟，可估计FWER, FDR,
TPR，输出到表格中。</p>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">FWER</th>
<th align="center">FDR</th>
<th align="center">TRP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Bonf</td>
<td align="center"><span class="math inline">\(\approx 0.1\)</span></td>
<td align="center"><span class="math inline">\(\ll 0.1\)</span></td>
<td align="center">?</td>
</tr>
<tr class="even">
<td align="center">B-H</td>
<td align="center"><span class="math inline">\(\gg 0.1\)</span></td>
<td align="center"><span class="math inline">\(\approx 0.1\)</span></td>
<td align="center">?</td>
</tr>
</tbody>
</table>
</div>
<div id="exercise-2." class="section level3">
<h3>Exercise 2.</h3>
<p>Suppose the population has the exponential distribution with rate
<span class="math inline">\(\lambda\)</span>, then the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat\lambda=1/\bar{X}\)</span>, where <span class="math inline">\(\bar{X}\)</span> is the sample mean. It can be
derived that the expectation of <span class="math inline">\(\hat\lambda\)</span> is <span class="math inline">\(\lambda n/(n-1)\)</span>, so that the estimation
bias is <span class="math inline">\(\lambda/(n-1)\)</span>. The standard
error <span class="math inline">\(\hat\lambda\)</span> is <span class="math inline">\(\lambda n/[(n-1)\sqrt{n-2}]\)</span>. Conduct a
simulation study to vertify the performance of the bootstrap method.</p>
<p>The true value of <span class="math inline">\(\lambda=2\)</span>.</p>
<p>The sample size <span class="math inline">\(n=5,10,20\)</span>.</p>
<p>The number of bootstrap replicates <span class="math inline">\(B=1000\)</span>.</p>
<p>The simulations are repeated for <span class="math inline">\(m=1000\)</span> times.</p>
<p>Compare the mean bootstrap bias and bootstrap standard error with the
theoretical ones. Comment on the results.</p>
</div>
<div id="exercise-7.3." class="section level3">
<h3>Exercise 7.3.</h3>
<p>Obtain a bootstrap t confidence interval estimate for the correlation
statistic in Example 7.2 (law data in bootstrap).</p>
</div>
</div>
<div id="answers-4" class="section level2">
<h2>Answers</h2>
<div id="exercise-1.-3" class="section level3">
<h3>Exercise 1.</h3>
<p>Suppose the result of multiple test problems is listed below.</p>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center"><span class="math inline">\(H_0\)</span> is true</th>
<th align="center"><span class="math inline">\(H_a\)</span> is true</th>
<th align="center">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Positive(reject <span class="math inline">\(H_0\)</span>)</td>
<td align="center">V</td>
<td align="center">S</td>
<td align="center">R</td>
</tr>
<tr class="even">
<td align="center">Negative(accept <span class="math inline">\(H_0\)</span>)</td>
<td align="center">U</td>
<td align="center">T</td>
<td align="center">m-R</td>
</tr>
<tr class="odd">
<td align="center">Total</td>
<td align="center"><span class="math inline">\(m_0\)</span></td>
<td align="center"><span class="math inline">\(m-m_0\)</span></td>
<td align="center">m</td>
</tr>
</tbody>
</table>
<p>We can calculate the FWER, FDR and TPR by the following formula:</p>
<p><span class="math display">\[\mathrm{FWER}=\mathrm{P}(V\ge
1)=1-(1-\frac{V}{m})^m,\]</span> <span class="math display">\[\mathrm{FDR}=\frac{V}{R},\]</span> <span class="math display">\[\mathrm{TPR}=\frac{S}{m-m_0}.\]</span></p>
<p>By the Bonferroni method and Benjamini-Hochberg method, the result
can be obtained using R.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>p_generate<span class="ot">&lt;-</span><span class="cf">function</span>(m,alt_prop){</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>  p1<span class="ot">&lt;-</span><span class="fu">runif</span>(m<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>alt_prop))</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>  <span class="fu">names</span>(p1)<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="st">&quot;null&quot;</span>,m<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>alt_prop))</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>  p2<span class="ot">&lt;-</span><span class="fu">rbeta</span>(m<span class="sc">*</span>alt_prop,<span class="fl">0.1</span>,<span class="dv">1</span>)</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>  <span class="fu">names</span>(p2)<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="st">&quot;alte&quot;</span>,m<span class="sc">*</span>alt_prop)</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sort</span>(<span class="fu">c</span>(p1,p2)))</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>}</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>statistic_cal<span class="ot">&lt;-</span><span class="cf">function</span>(p){</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>  FWER<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">length</span>(<span class="fu">which</span>(p<span class="sc">&lt;</span><span class="fl">0.1</span> <span class="sc">&amp;</span> <span class="fu">names</span>(p)<span class="sc">==</span><span class="st">&quot;null&quot;</span>))<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">^</span><span class="dv">1000</span></span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>  FDR<span class="ot">&lt;-</span><span class="fu">length</span>(<span class="fu">which</span>(p<span class="sc">&lt;</span><span class="fl">0.1</span> <span class="sc">&amp;</span> <span class="fu">names</span>(p)<span class="sc">==</span><span class="st">&quot;null&quot;</span>))<span class="sc">/</span><span class="fu">length</span>(<span class="fu">which</span>(p<span class="sc">&lt;</span><span class="fl">0.1</span>))</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>  TPR<span class="ot">&lt;-</span><span class="fu">length</span>(<span class="fu">which</span>(p<span class="sc">&lt;</span><span class="fl">0.1</span> <span class="sc">&amp;</span> <span class="fu">names</span>(p)<span class="sc">==</span><span class="st">&quot;alte&quot;</span>))<span class="sc">/</span>(<span class="dv">1000</span><span class="sc">*</span><span class="fl">0.05</span>)</span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(FWER,FDR,TPR))</span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>}</span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a>FWER<span class="ot">&lt;-</span>FDR<span class="ot">&lt;-</span>TPR<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> M,<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231016</span>)</span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a>  p<span class="ot">&lt;-</span><span class="fu">p_generate</span>(<span class="dv">1000</span>,<span class="fl">0.05</span>)</span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a>  adj.bonf<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p,<span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a>  adj.BH<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&#39;BH&#39;</span>)</span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a>  sc.bonf<span class="ot">&lt;-</span><span class="fu">statistic_cal</span>(adj.bonf)</span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a>  sc.BH<span class="ot">&lt;-</span><span class="fu">statistic_cal</span>(adj.BH)</span>
<span id="cb45-25"><a href="#cb45-25" tabindex="-1"></a>  FWER[i,]<span class="ot">&lt;-</span><span class="fu">c</span>(sc.bonf[<span class="dv">1</span>],sc.BH[<span class="dv">1</span>])</span>
<span id="cb45-26"><a href="#cb45-26" tabindex="-1"></a>  FDR[i,]<span class="ot">&lt;-</span><span class="fu">c</span>(sc.bonf[<span class="dv">2</span>],sc.BH[<span class="dv">2</span>])</span>
<span id="cb45-27"><a href="#cb45-27" tabindex="-1"></a>  TPR[i,]<span class="ot">&lt;-</span><span class="fu">c</span>(sc.bonf[<span class="dv">3</span>],sc.BH[<span class="dv">3</span>])</span>
<span id="cb45-28"><a href="#cb45-28" tabindex="-1"></a>}</span>
<span id="cb45-29"><a href="#cb45-29" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">FWER=</span><span class="fu">c</span>(<span class="fu">mean</span>(FWER[,<span class="dv">1</span>]),<span class="fu">mean</span>(FWER[,<span class="dv">2</span>])),<span class="at">FDR=</span><span class="fu">c</span>(<span class="fu">mean</span>(FDR[,<span class="dv">1</span>]),<span class="fu">mean</span>(FDR[,<span class="dv">2</span>])),<span class="at">TPR=</span><span class="fu">c</span>(<span class="fu">mean</span>(TPR[,<span class="dv">1</span>]),<span class="fu">mean</span>(TPR,<span class="dv">2</span>)))</span>
<span id="cb45-30"><a href="#cb45-30" tabindex="-1"></a><span class="fu">row.names</span>(data)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Bonf&quot;</span>,<span class="st">&quot;BH&quot;</span>)</span>
<span id="cb45-31"><a href="#cb45-31" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb45-32"><a href="#cb45-32" tabindex="-1"></a><span class="fu">kable</span>(data,<span class="at">align =</span> <span class="st">&quot;ccc&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">FWER</th>
<th align="center">FDR</th>
<th align="center">TPR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bonf</td>
<td align="center">0.0605998</td>
<td align="center">0.0048328</td>
<td align="center">0.39862</td>
</tr>
<tr class="even">
<td align="left">BH</td>
<td align="center">0.8279945</td>
<td align="center">0.0959323</td>
<td align="center">0.48000</td>
</tr>
</tbody>
</table>
</div>
<div id="exercise-2.-1" class="section level3">
<h3>Exercise 2.</h3>
<p>The bootstrap is performed by the following steps:</p>
<ul>
<li>For each <span class="math inline">\(n\)</span> and <span class="math inline">\(i=1,2,\cdots,m\)</span>:
<ul>
<li>generate random numbers <span class="math inline">\(X_1,\cdots,X_n\sim
\mathrm{Exp}(\lambda)\)</span>.</li>
<li>generate bootstrap sampling <span class="math inline">\(\hat\theta_1,\cdots,\hat\theta_B\)</span> and
calculate sample mean <span class="math inline">\(\hat\theta\)</span>.</li>
<li><span class="math inline">\(\mathrm{Bias}(\theta)_i\leftarrow\mathrm{mean}(\hat\theta_i)-\hat\theta\)</span>.</li>
<li><span class="math inline">\(\hat\theta^*_i\leftarrow\mathrm{mean}(\hat\theta_i)\)</span>.</li>
</ul></li>
<li><span class="math inline">\(\mathrm{Bias}=\mathrm{mean}(\mathrm{Bias}(\theta)_i)\)</span>,
<span class="math inline">\(\mathrm{SE}=sd(\hat\theta^*_i)\)</span>.</li>
</ul>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>data_show<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>lambdahat<span class="ot">&lt;-</span>lambdabias<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>samL<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>bootf<span class="ot">&lt;-</span><span class="cf">function</span>(x,i){</span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x[i]))</span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>}</span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231016</span>)</span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> n){</span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rexp</span>(i,<span class="at">rate =</span> lambda)</span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a>    obj<span class="ot">&lt;-</span><span class="fu">boot</span>(x,<span class="at">statistic =</span> bootf,<span class="at">R =</span> B)</span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a>    lambdabias[j]<span class="ot">&lt;-</span><span class="fu">mean</span>(obj<span class="sc">$</span>t)<span class="sc">-</span>obj<span class="sc">$</span>t0</span>
<span id="cb46-19"><a href="#cb46-19" tabindex="-1"></a>    lambdahat[j]<span class="ot">&lt;-</span><span class="fu">mean</span>(obj<span class="sc">$</span>t)</span>
<span id="cb46-20"><a href="#cb46-20" tabindex="-1"></a>  }</span>
<span id="cb46-21"><a href="#cb46-21" tabindex="-1"></a>  data_show[<span class="fu">which</span>(n<span class="sc">==</span>i),]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(lambdabias),lambda<span class="sc">/</span>(i<span class="dv">-1</span>),<span class="fu">sd</span>(lambdahat),lambda<span class="sc">*</span>i<span class="sc">/</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(i<span class="dv">-2</span>))</span>
<span id="cb46-22"><a href="#cb46-22" tabindex="-1"></a>}</span>
<span id="cb46-23"><a href="#cb46-23" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(data_show)</span>
<span id="cb46-24"><a href="#cb46-24" tabindex="-1"></a><span class="fu">colnames</span>(d)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Bias.Boot&quot;</span>,<span class="st">&quot;Bias.Theo&quot;</span>,<span class="st">&quot;SE.Boot&quot;</span>,<span class="st">&quot;SE.Theo&quot;</span>)</span>
<span id="cb46-25"><a href="#cb46-25" tabindex="-1"></a><span class="fu">rownames</span>(d)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;n=5&quot;</span>,<span class="st">&quot;n=10&quot;</span>,<span class="st">&quot;n=20&quot;</span>)</span>
<span id="cb46-26"><a href="#cb46-26" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb46-27"><a href="#cb46-27" tabindex="-1"></a><span class="fu">kable</span>(d,<span class="at">align =</span> <span class="st">&quot;cccc&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Bias.Boot</th>
<th align="center">Bias.Theo</th>
<th align="center">SE.Boot</th>
<th align="center">SE.Theo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">n=5</td>
<td align="center">0.5691134</td>
<td align="center">0.5000000</td>
<td align="center">1.7120759</td>
<td align="center">1.4433757</td>
</tr>
<tr class="even">
<td align="left">n=10</td>
<td align="center">0.2208163</td>
<td align="center">0.2222222</td>
<td align="center">0.8475517</td>
<td align="center">0.7856742</td>
</tr>
<tr class="odd">
<td align="left">n=20</td>
<td align="center">0.1042208</td>
<td align="center">0.1052632</td>
<td align="center">0.5616497</td>
<td align="center">0.4962153</td>
</tr>
</tbody>
</table>
</div>
<div id="exercise-7.3.-1" class="section level3">
<h3>Exercise 7.3.</h3>
<p>The bootstrap is performed by the following steps:</p>
<ul>
<li>For <span class="math inline">\(i=1,2,\cdots,B\)</span>:
<ul>
<li>generate sample <span class="math inline">\(X_1,\cdots,X_n\)</span>
from dataset <em>law</em>, <span class="math inline">\(n=\mathrm{nrow(law)}\)</span>.</li>
<li>calculate the correlation coefficient <span class="math inline">\(\hat\theta_i^c\)</span>.</li>
<li>resample from <span class="math inline">\(X_1,\cdots,X_n\)</span>,
denote the result as <span class="math inline">\(Y_1,\cdots,Y_n\)</span>, calculate the SE of its
correlation coefficient <span class="math inline">\(\hat{se}\)</span>.</li>
<li><span class="math inline">\(t\)</span> statistics is obtained by
<span class="math inline">\(t_i=\frac{\hat\theta_i^c-\mathrm{mean}(\hat\theta_i^c)}{\mathrm{mean}(\hat{se})}\)</span>.</li>
</ul></li>
<li>The CI of <span class="math inline">\(t\)</span> interval is
obtained</li>
</ul>
<p><span class="math display">\[(\mathrm{mean}(\hat{\theta}_i^c)-se(\hat\theta_i^c)*t(0.975),\mathrm{mean}(\hat{\theta}_i^c)-se(\hat\theta_i^c)*t(0.025)).\]</span></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a><span class="co"># cor.law&lt;-cor(law$LSAT,law$GPA)</span></span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(law)</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>boot.cor<span class="ot">&lt;-</span><span class="cf">function</span>(x,i){</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>]))</span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>}</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>cor.hat<span class="ot">&lt;-</span>se.boot<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231016</span>)</span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">replace =</span> T)</span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>  LSAT.b<span class="ot">&lt;-</span>law<span class="sc">$</span>LSAT[x]</span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>  GPA.b<span class="ot">&lt;-</span>law<span class="sc">$</span>GPA[x]</span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a>  cor.hat[i]<span class="ot">&lt;-</span><span class="fu">cor</span>(LSAT.b,GPA.b)</span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a>  obj<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="fu">data.frame</span>(LSAT.b,GPA.b),<span class="at">statistic =</span> boot.cor,<span class="at">R =</span> B)</span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a>  se.boot[i]<span class="ot">&lt;-</span><span class="fu">sd</span>(obj<span class="sc">$</span>t)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a>}</span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a>t<span class="ot">&lt;-</span>(cor.hat<span class="sc">-</span><span class="fu">mean</span>(cor.hat))<span class="sc">/</span><span class="fu">mean</span>(se.boot)</span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a>ci<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(cor.hat)<span class="sc">-</span><span class="fu">sd</span>(cor.hat)<span class="sc">/</span><span class="fu">sqrt</span>(n)<span class="sc">*</span><span class="fu">quantile</span>(t,<span class="fl">0.975</span>),<span class="fu">mean</span>(cor.hat)<span class="sc">-</span><span class="fu">sd</span>(cor.hat)<span class="sc">/</span><span class="fu">sqrt</span>(n)<span class="sc">*</span><span class="fu">quantile</span>(t,<span class="fl">0.025</span>))</span>
<span id="cb47-22"><a href="#cb47-22" tabindex="-1"></a><span class="fu">names</span>(ci)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;2.5%&quot;</span>,<span class="st">&quot;97.5%&quot;</span>)</span>
<span id="cb47-23"><a href="#cb47-23" tabindex="-1"></a>ci</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.5672757 1.0946523</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">hist</span>(t)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2///T09PbkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///9nY54hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIKklEQVR4nO2de3/aNhSGnS5Z2Fh3CUu3ht3jbGNzmw4I+Pt/slmWDXaC9PpyLAnlff5IKUFH6PnJx7IlK0lOrCS+v0DoUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAHgvbL5Gqt/70+/Kfx6z//ka7wYZYk3wpF9y7o6faNtKBNUnAjFN21oBekibigLLm4F4vuqQd9mCfJxTcr1YIC1YjHd0ny2Q9l59o/JMnlfdm2oq2/3SZvVvnjbfG5t0W7d4vk+nGeXLzPP8yKTx2rOQQoQ2pFh+jD8SMoS5Lqq9dNqN5RHyw+olo4P759td7oXxfNLgRp5u3GHwOco6CaSpDqBev8Y5ko9EGwnVXebsoUcr3ep7W3q1X+X1Hq87X60E0p6EaVTd5Xny9pBjjDQ+yZoKI1l39Xv9VNqBqS6k6lXhcitKC76oOf/pqrAMX7hQn9szTWDJPXx+WZC9Lv6IxTNqE+ClXT6tettu5/rgOo3pdXP4+CmgHOUdDzHPR0q1PKH1UTdHvLo+uuft0UpIxe/vppYRTUDBCDoGKA8su8TqkdepA2sTMLiq0H6fd/OmYccw4q21p2jEOSPiHo3HPQM0FFe78rj7PyxKNaYz6L1T3oav20NOcg01ms8XIgfnrQw2FYU14X2MZBhxxkTdLNcVDTyuZMxkEvDrGPKgO9XeXVsHlVDYR/1AWKt75evTiLXf6eFW+ZBDUCNATV0YcT7u2O9Pllvx8CFJSW9yqK3nHi0tY9AQqqrrtGp1cZAhSUP72bVdf6ARCioKCgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQD9B9fyU+KKwcOklKKunoTaN+ajI6SNovzzOYwYxZ+WCPoJ2i3oxU755NQcZexCgZw6quhBzkIF6iemr6T8cB0EoCMCBIoADRQBP8wCZgeJhpXh8KU24B3kQlDSZIHyfD+OBog9B/x7xLQgPFF+7INfhOlVJQaDKkASp5exlGsoMQ8VXLigrH4lUy5cp6BT6NL9fqqdGKOgE9UAxvVpT0CkOA8X0OlRB8oPGfjmo0qIfdhsdbjgtEU1B8r2p71lMH2T7pWdBJim+BbkOZ6yGgkA1FASq8SCofvJcKNy0+OlB6jpi7J3UqAXlAo5iF6QVjZiziFzQprxYLy+2JMJNhxdB6m6hNjNi6UbEgnYLiaeMIxYUZDhjNV4EpcUBNnbKNGZBaZmA9A1DgXCT0kmQzK2PRg7SF+qDMrTrmdVOgmR606FofTfMdCusZ7hp8SGouteznUUzkpYWpPZbGb2jSNSCJKAgt+GM1fgQJLK8LmZBqcTCw4gF7RYSyw6jFnRn+1zfcNPiZ6AosadaxIKK61SBLhSxoMNO3zyLtauS+9YThDNWE6ogOFaKWlC5DXpqO9njRxFiFrS5uM/UfvxmQ+EsJPd1PyizLK7LOz2zGrEg1XolyHJHkT1INTu1zBoG8yiCxxyUWYeLoTyK4O0sxjuKL6uS+9YThGuF7rJw07cgnwPF3lKEBXW5FvM6UPQtqMI2b+j3NB+IoDw13xby+8xqKIKCHSiGIsg29ex1oBiIIPvqDp8DRd+CZDZ2iViQDBTkNlwrtGdBh4HiqPv2EQuqpn1sV/MdHEYsaL/UZmz7uhifo3sZTh7fgnbf6xsd1jWKcPo1YkF1D7LdUcTTrxELUncUc713wJhWjCkMQvsWpHPwyJ2lohYkAQW5DdcK7V0QnnruFU6CUfehpQXhqede4UQYJUVYUIep5z7hZAhJUIep5z7hZAhJUJep5x7hZAhJUKep5x7hRAhKUIhTz2EJkiBiQY05nTEtEojRDBeQoCBX2ockaNT5XXJmVWz0LN6DAllILiZFugeJQEHThwtSkEyGziMXJHGip6BO4caFoCAQgoJACAoCISgIhAhTkMTSjjxeQWJQ0PThKOhUsSmu4JuvmzhpkXC4SaSYXjtpkXA4CkLFKAgUoyBQjIJAMQo68dGpT+1nL8ilFFeCJJ9ZjVHQ6GdWvR1WbgR1fuKw5aFZgzcpbgR1fmY1CZrpBPEv9SLwM6vx0a/DyTy3eVZMuPI7DlwJOpOUfOKLS7R+dD2+ftsBCgJQEICCABQEoCAABQEoCEBBAF5qACgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBDAiaDtl2omX8869v8rZrZyG9teEUMrbOFC0G5RLnXYfjFs2wtLObUx3cZoaGiFLRwI2lQLroY+mG8up1dTGPdQH7fTT8X0gjbJjf6m2cDObi63nZW7q5o8DK2whZMcpAWlXxUZYcCqEHM5fQwZO8rQClu4E7RbqDUh/TeRs5TT6ceUhIZW2MZhD3r+cmiIxptWQeMqrHEtSKeN/pwsBw6xURXWTCkoq1NAU1CfU292zCEny4Ek3b/CE7jrQbo1/Xu8pZz9ND+0wjYuz2KqIQNypqWcfaA4tMIWLnNQWhwxQxKCpVxm3ZZuaIVNeLEKoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQHOQNBG6I+iDCN8QWJ/NWYYFAQIXtB25ndHsOAFsQchKAhAQQAKAlAQgIIAu4XXbVHDF5SnHAeFDAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBPgfK3CdQtTvrx0AAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
</div>
<div id="homework-5" class="section level1">
<h1>Homework 5</h1>
<div id="questions-5" class="section level2">
<h2>Questions</h2>
<div id="exercise-7.5." class="section level3">
<h3>Exercise 7.5.</h3>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
</div>
<div id="exercise-7.8." class="section level3">
<h3>Exercise 7.8.</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
</div>
<div id="exercise-7.11." class="section level3">
<h3>Exercise 7.11.</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
</div>
</div>
<div id="answers-5" class="section level2">
<h2>Answers</h2>
<div id="exercise-7.5.-1" class="section level3">
<h3>Exercise 7.5.</h3>
<p>The bootstrap is performed by the following steps:</p>
<ul>
<li>for <span class="math inline">\(i=1,2,\cdots,R\)</span>
<ul>
<li>generate sample <span class="math inline">\(X_1,\cdots,X_n\)</span>
from dataset <em>aircondit</em>, <span class="math inline">\(n=\mathrm{nrow(aircondit)}\)</span>.</li>
<li>obtain the bootstrap sample <span class="math inline">\(\hat\theta^B_i=\frac{1}{n}\sum_{i=1}^nX_i\)</span>.</li>
</ul></li>
<li>calculate the CI using <em>boot.ci()</em> function.</li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>x<span class="ot">&lt;-</span>aircondit<span class="sc">$</span>hours</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231023</span>)</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>boot.mean<span class="ot">&lt;-</span><span class="cf">function</span>(x,i){</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(x[i]))</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>}</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>obj<span class="ot">&lt;-</span><span class="fu">boot</span>(x,<span class="at">statistic =</span> boot.mean,<span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(obj,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>ci</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 31.1, 181.8 )   ( 25.4, 167.7 )  
## 
## Level     Percentile            BCa          
## 95%   ( 48.5, 190.7 )   ( 54.1, 216.0 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>The reason these intervals may differ is due to their assumptions and
methods of correction:</p>
<ul>
<li><p><strong>Standard Normal Interval</strong>. Assumes that the
distribution of the statistic is approximately normal. This method can
be less accurate if the distribution is not normal.</p></li>
<li><p><strong>Basic and Percentile Intervals</strong>. These methods
are non-parametric and don’t rely on assumptions about the underlying
distribution. They are simple and robust but may have wider intervals if
the underlying distribution is skewed or not normal.</p></li>
<li><p><strong>BCa Interval</strong>. The BCa method corrects for both
bias and acceleration. It can perform better than the other methods when
the distribution of the statistic is not well-behaved. It adjusts for
potential bias and skewness in the resampling distribution.</p></li>
</ul>
</div>
<div id="exercise-7.8.-1" class="section level3">
<h3>Exercise 7.8.</h3>
<p>The jackknife estimates is obtained by the following steps:</p>
<ul>
<li>for <span class="math inline">\(i=1,2,\cdots,n\)</span>, <span class="math inline">\(n=\mathrm{nrow(scor)}\)</span>:
<ul>
<li>ignore the <span class="math inline">\(i\)</span>-th row of dataset
<em>scor</em> and calculate the correlation matrix <span class="math inline">\(\Sigma_i=\mathrm{cor}(\hat\theta_{(i)})\)</span>.</li>
<li>obtain the eigenvalue of correlation matrix <span class="math inline">\(\Sigma_i\)</span>, denote as <span class="math inline">\(\lambda_1\ge\lambda_2\ge\cdots\ge\lambda_{m}\)</span>,
<span class="math inline">\(m=\mathrm{ncol(scor)}\)</span>.</li>
<li>obtain jackknife estimates <span class="math inline">\(\hat\theta_i=\frac{\lambda_1}{\sum_{j=1}^{m}\lambda_j}\)</span>.</li>
</ul></li>
<li>use the entire dataset to calculate <span class="math inline">\(\hat\theta=\frac{\lambda_1}{\sum_{j=1}^{m}\lambda_j}\)</span>,
<span class="math inline">\(\lambda_i,i=1,\cdots,m\)</span> is the
eigenvalue of correlation matrix of <em>scor</em>.</li>
<li>obtain <span class="math inline">\(bias=(n-1)\times(\mathrm{mean}(\hat\theta_i)-\hat\theta)\)</span>
and <span class="math inline">\(se=\sqrt{\frac{n-1}{n}\sum_{i=1}^{n}(\hat\theta_i-\mathrm{mean}(\hat\theta_i))^2}\)</span>.</li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>x<span class="ot">&lt;-</span>scor</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(x)</span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>Sigma<span class="ot">&lt;-</span><span class="fu">cor</span>(x)</span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span><span class="fu">eigen</span>(Sigma)<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">eigen</span>(Sigma)<span class="sc">$</span>values)</span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a>jackknife.bias.se<span class="ot">&lt;-</span><span class="cf">function</span>(x,n){</span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>  theta.jack.hat<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>    Sigma<span class="ot">&lt;-</span><span class="fu">cor</span>(x[<span class="sc">-</span>i,])</span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a>    theta.jack.hat[i]<span class="ot">&lt;-</span><span class="fu">eigen</span>(Sigma)<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">eigen</span>(Sigma)<span class="sc">$</span>values)</span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a>  }</span>
<span id="cb52-13"><a href="#cb52-13" tabindex="-1"></a>  <span class="fu">return</span>(theta.jack.hat)</span>
<span id="cb52-14"><a href="#cb52-14" tabindex="-1"></a>}</span>
<span id="cb52-15"><a href="#cb52-15" tabindex="-1"></a>theta.jack.hat<span class="ot">&lt;-</span><span class="fu">jackknife.bias.se</span>(x,n)</span>
<span id="cb52-16"><a href="#cb52-16" tabindex="-1"></a>bias<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack.hat)<span class="sc">-</span>theta.hat)</span>
<span id="cb52-17"><a href="#cb52-17" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">sum</span>((theta.jack.hat<span class="sc">-</span><span class="fu">mean</span>(theta.jack.hat))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb52-18"><a href="#cb52-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bias=&quot;</span>,bias,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;se=&quot;</span>,se,<span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## bias=-0.0003778535
## se=0.04466684</code></pre>
</div>
<div id="exercise-7.11.-1" class="section level3">
<h3>Exercise 7.11.</h3>
<p>The leave-two-out cross validation is performed by the following
steps:</p>
<ul>
<li>for <span class="math inline">\(i=1,2,\cdots,n\)</span>, <span class="math inline">\(n=\mathrm{nrow(ironslag)}\)</span>:
<ul>
<li>for <span class="math inline">\(j=i+1,\cdots,n\)</span>:
<ul>
<li>obtain the data without the <span class="math inline">\(i,j\)</span>-th row.</li>
<li>make regression.</li>
<li>apply the regression result to the <span class="math inline">\(i,j\)</span>-th row and calculate the bias.</li>
</ul></li>
<li>End loop if the iteration reaches <span class="math inline">\(n(n-1)/2\)</span>, that is, <span class="math inline">\(i=n-1\)</span>.</li>
</ul></li>
<li>calculate the average squared prediction error.</li>
</ul>
<p>We establish 4 models to make the regression, that is, <span class="math display">\[y=\beta_0+\beta_1x+\varepsilon,\]</span> <span class="math display">\[y=\beta_0+\beta_1x+\beta_2x^2+\varepsilon,\]</span>
<span class="math display">\[\log(y)=\beta_0+\beta_1x+\varepsilon,\]</span>
<span class="math display">\[\log(y)=\beta_0+\beta_1\log(x)+\varepsilon.\]</span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>x<span class="ot">&lt;-</span>ironslag</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a><span class="fu">plot</span>(x)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(x)</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>e1<span class="ot">&lt;-</span>e2<span class="ot">&lt;-</span>e3<span class="ot">&lt;-</span>e4<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> n<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>,<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>count<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>    del<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="sc">-</span>i,<span class="sc">-</span>j)</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>    pre.x<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">&#39;chemical&#39;</span> <span class="ot">=</span> x<span class="sc">$</span>chemical[<span class="sc">-</span>del])</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>    train.x<span class="ot">&lt;-</span>x[del,]</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>    </span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>    model<span class="fl">.1</span><span class="ot">&lt;-</span><span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical,<span class="at">data =</span> train.x)</span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a>    pre<span class="fl">.1</span><span class="ot">&lt;-</span><span class="fu">predict</span>(model<span class="fl">.1</span>,<span class="at">newdata =</span> pre.x)</span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>    e1[count,]<span class="ot">&lt;-</span>pre<span class="fl">.1</span><span class="sc">-</span>x<span class="sc">$</span>magnetic[<span class="sc">-</span>del]</span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>    </span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a>    model<span class="fl">.2</span><span class="ot">&lt;-</span><span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>),<span class="at">data =</span> train.x)</span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a>    pre<span class="fl">.2</span><span class="ot">&lt;-</span><span class="fu">predict</span>(model<span class="fl">.2</span>,<span class="at">newdata =</span> pre.x)</span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a>    e2[count,]<span class="ot">&lt;-</span>pre<span class="fl">.2</span><span class="sc">-</span>x<span class="sc">$</span>magnetic[<span class="sc">-</span>del]</span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>    </span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a>    model<span class="fl">.3</span><span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(magnetic) <span class="sc">~</span> chemical,<span class="at">data =</span> train.x)</span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>    pre<span class="fl">.3</span><span class="ot">&lt;-</span><span class="fu">predict</span>(model<span class="fl">.3</span>,<span class="at">newdata =</span> pre.x)</span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a>    e3[count,]<span class="ot">&lt;-</span><span class="fu">exp</span>(pre<span class="fl">.3</span>)<span class="sc">-</span>x<span class="sc">$</span>magnetic[<span class="sc">-</span>del]</span>
<span id="cb55-22"><a href="#cb55-22" tabindex="-1"></a>    </span>
<span id="cb55-23"><a href="#cb55-23" tabindex="-1"></a>    model<span class="fl">.4</span><span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(magnetic) <span class="sc">~</span> <span class="fu">log</span>(chemical),<span class="at">data =</span> train.x)</span>
<span id="cb55-24"><a href="#cb55-24" tabindex="-1"></a>    pre<span class="fl">.4</span><span class="ot">&lt;-</span><span class="fu">predict</span>(model<span class="fl">.4</span>,<span class="at">newdata =</span> pre.x)</span>
<span id="cb55-25"><a href="#cb55-25" tabindex="-1"></a>    e4[count,]<span class="ot">&lt;-</span><span class="fu">exp</span>(pre<span class="fl">.4</span>)<span class="sc">-</span>x<span class="sc">$</span>magnetic[<span class="sc">-</span>del]</span>
<span id="cb55-26"><a href="#cb55-26" tabindex="-1"></a>    </span>
<span id="cb55-27"><a href="#cb55-27" tabindex="-1"></a>    count<span class="ot">&lt;-</span>count<span class="sc">+</span><span class="dv">1</span> </span>
<span id="cb55-28"><a href="#cb55-28" tabindex="-1"></a>  }</span>
<span id="cb55-29"><a href="#cb55-29" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> n<span class="dv">-1</span>) <span class="cf">break</span> </span>
<span id="cb55-30"><a href="#cb55-30" tabindex="-1"></a>}</span>
<span id="cb55-31"><a href="#cb55-31" tabindex="-1"></a>out<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb55-32"><a href="#cb55-32" tabindex="-1"></a>out</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>Model 2 has the smallest average squared prediction error, which is
the same as Example 7.18.</p>
</div>
</div>
</div>
<div id="homework-6" class="section level1">
<h1>Homework 6</h1>
<div id="questions-6" class="section level2">
<h2>Questions</h2>
<div id="exercise-1.-4" class="section level3">
<h3>Exercise 1.</h3>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
</div>
<div id="exercise-8.1." class="section level3">
<h3>Exercise 8.1.</h3>
<p>Implement the two-sample Cramer-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
</div>
<div id="exercise-8.3." class="section level3">
<h3>Exercise 8.3.</h3>
<p>The Count 5 test for equal variances in Section 6.4 is based on the
maximum number of extreme points. Example 6.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</p>
</div>
</div>
<div id="answers-6" class="section level2">
<h2>Answers</h2>
<div id="exercise-1.-5" class="section level3">
<h3>Exercise 1.</h3>
That is to prove <span class="math inline">\(K(s,r)f(s)=K(r,s)f(r)\)</span>.
<span class="math display">\[\begin{aligned}
K(s,r)f(s) &amp; = I(s\ne
r)\alpha(s,r)g(r|s)f(s)+I(s=r)[1-\int\alpha(s,r)g(r|s)]f(s) \\
&amp; = \left\{
\begin{matrix}
&amp; I(s\ne r)f(r)g(s|r)+I(s=r)[f(s)-\int
f(r)g(s|r)],~~f(r)g(s|r)&lt;f(s)g(r|s)\\
&amp; I(s\ne r)f(s)g(r|s)+I(s=r)[f(s)-\int f(s)g(r|s)],~~f(r)g(s|r)\ge
f(s)g(r|s).
\end{matrix}\right.
\end{aligned}\]</span>
And
<span class="math display">\[\begin{aligned}
K(r,s)f(r) &amp; = I(s\ne
r)\alpha(r,s)f(r)g(s|r)+I(s=r)[1-\int\alpha(r,s)g(s|r)]f(r) \\
&amp; = \left\{
\begin{matrix}
&amp; I(s\ne r)f(s)g(r|s)+I(s=r)[f(r)-\int f(s)g(r|s)],~~f(s)g(r|s)\le
f(r)g(s|r) \\
&amp; I(s\ne r)f(r)g(s|r)+I(s=r)[f(r)-\int
f(r)g(s|r)],~~f(s)g(r|s)&gt;f(r)g(s|r).
\end{matrix}\right.
\end{aligned}\]</span>
<p>We have <span class="math inline">\(K(r,s)f(r)=K(s,r)f(s)\)</span>
when <span class="math inline">\(f(r)g(s|r)&lt;f(s)g(r|s)\)</span> and
<span class="math inline">\(f(s)g(r|s)&gt;f(r)g(s|r)\)</span>. Thus,
<span class="math inline">\(K(r,s)f(r)=K(s,r)f(s)\)</span> is
proved.</p>
</div>
<div id="exercise-8.1.-1" class="section level3">
<h3>Exercise 8.1.</h3>
<p>The two-sample Cramer-von Mises test can be implemented in the
following steps.</p>
<ul>
<li>pooled samples <span class="math inline">\(z=(x,y)\)</span>, where
<span class="math inline">\(x\)</span> is <em>soybean</em> data and
<span class="math inline">\(y\)</span> is <em>linseed</em> data.</li>
<li>for <span class="math inline">\(i=1,2,\cdots,N\)</span>:
<ul>
<li>permutate from sample <span class="math inline">\(z\)</span> to
obtain <span class="math inline">\(z^*=(x^*,y^*)\)</span>.</li>
<li>calculate the Cramer-von Mises statistic by <span class="math display">\[W_2^i=\frac{mn}{m+n}[\sum_{i=1}^n(F_n(x_i)-G_m(x_i))^2+\sum_{j=1}^m(F_n(y_j)-G_m(y_j))^2].\]</span></li>
</ul></li>
<li>calculate <span class="math inline">\(W_2^{t_0}\)</span> using <span class="math inline">\(z=(x,y)\)</span> and <span class="math inline">\(W_2^*=(W_2^{t_0},W_2)\)</span>.</li>
<li>p value <span class="math inline">\(p=\mathrm{mean}(W_2^*&gt;W_2^{t_0})\)</span>.</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">c</span>(x,y)</span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">length</span>(y)</span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span>(n<span class="sc">+</span>m)</span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">999</span></span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>W2<span class="ot">&lt;-</span><span class="fu">numeric</span>(N<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a>cal.W2<span class="ot">&lt;-</span><span class="cf">function</span>(z,n,m){</span>
<span id="cb57-13"><a href="#cb57-13" tabindex="-1"></a>  x<span class="ot">&lt;-</span>z[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb57-14"><a href="#cb57-14" tabindex="-1"></a>  y<span class="ot">&lt;-</span>z[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>n)]</span>
<span id="cb57-15"><a href="#cb57-15" tabindex="-1"></a>  Fx<span class="ot">&lt;-</span><span class="fu">ecdf</span>(x)</span>
<span id="cb57-16"><a href="#cb57-16" tabindex="-1"></a>  Fy<span class="ot">&lt;-</span><span class="fu">ecdf</span>(y)</span>
<span id="cb57-17"><a href="#cb57-17" tabindex="-1"></a>  <span class="fu">return</span>((<span class="fu">sum</span>((<span class="fu">Fx</span>(x)<span class="sc">-</span><span class="fu">Fy</span>(x))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">sum</span>((<span class="fu">Fx</span>(y)<span class="sc">-</span><span class="fu">Fy</span>(y))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span>m<span class="sc">*</span>n<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb57-18"><a href="#cb57-18" tabindex="-1"></a>}</span>
<span id="cb57-19"><a href="#cb57-19" tabindex="-1"></a>W2[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">cal.W2</span>(z,n,m)</span>
<span id="cb57-20"><a href="#cb57-20" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231030</span>)</span>
<span id="cb57-21"><a href="#cb57-21" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb57-22"><a href="#cb57-22" tabindex="-1"></a>  index<span class="ot">&lt;-</span><span class="fu">sample</span>(k,<span class="at">size =</span> n,<span class="at">replace =</span> F)</span>
<span id="cb57-23"><a href="#cb57-23" tabindex="-1"></a>  x0<span class="ot">&lt;-</span>z[index]</span>
<span id="cb57-24"><a href="#cb57-24" tabindex="-1"></a>  y0<span class="ot">&lt;-</span>z[<span class="sc">-</span>index]</span>
<span id="cb57-25"><a href="#cb57-25" tabindex="-1"></a>  W2[i<span class="sc">+</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">cal.W2</span>(<span class="fu">c</span>(x0,y0),n,m)</span>
<span id="cb57-26"><a href="#cb57-26" tabindex="-1"></a>}</span>
<span id="cb57-27"><a href="#cb57-27" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">mean</span>(W2<span class="sc">&gt;</span>W2[<span class="dv">1</span>])</span>
<span id="cb57-28"><a href="#cb57-28" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.396</code></pre>
<p>Thus, we think the null hypothesis holds.</p>
</div>
<div id="exercise-8.3.-1" class="section level3">
<h3>Exercise 8.3.</h3>
<p>Take <span class="math inline">\(X_1,\cdots,X_{n_1},iid\sim
N(0,1)\)</span> and <span class="math inline">\(Y_1,\cdots,Y_{n_2},iid\sim N(0,1)\)</span> for
example.</p>
<p>The steps are listed below.</p>
<ul>
<li>Count Five Test Function:
<ul>
<li>for given data <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, suppose their length are <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span>.</li>
<li>centralization: <span class="math inline">\(x_i\leftarrow x_i-\bar
x_i\)</span>.</li>
<li><span class="math inline">\(out_i\leftarrow \sum (x_i&lt;\min
x_j)+\sum(x_i&gt;\max x_j),i\ne j\)</span>.</li>
<li>output Boolean value: <span class="math inline">\(\max(out_1,out_2)&gt;5\)</span>.</li>
</ul></li>
<li>Permutation Function:
<ul>
<li>pooled samples <span class="math inline">\(z=(x,y)\)</span>. For
<span class="math inline">\(i=1,2,\cdots,N\)</span>:
<ul>
<li>permutate from sample <span class="math inline">\(z\)</span> to
obtain <span class="math inline">\(z^*=(x^*,y^*)\)</span>.</li>
<li>obtain Boolean value <span class="math inline">\(counter_i\)</span>
using Count Five Test Function.</li>
</ul></li>
<li>output the mean value of <span class="math inline">\(counter\)</span>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>n1<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>n2<span class="ot">&lt;-</span><span class="dv">30</span></span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>mu1<span class="ot">&lt;-</span>mu2<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>sigma2<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>count5.test<span class="ot">&lt;-</span><span class="cf">function</span>(x1,x2){</span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a>  x1<span class="ot">&lt;-</span>x1<span class="sc">-</span><span class="fu">mean</span>(x1)</span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a>  x2<span class="ot">&lt;-</span>x2<span class="sc">-</span><span class="fu">mean</span>(x2)</span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a>  out1<span class="ot">&lt;-</span><span class="fu">sum</span>(x1<span class="sc">&lt;</span><span class="fu">min</span>(x2))<span class="sc">+</span><span class="fu">sum</span>(x1<span class="sc">&gt;</span><span class="fu">max</span>(x2))</span>
<span id="cb59-11"><a href="#cb59-11" tabindex="-1"></a>  out2<span class="ot">&lt;-</span><span class="fu">sum</span>(x2<span class="sc">&lt;</span><span class="fu">min</span>(x1))<span class="sc">+</span><span class="fu">sum</span>(x2<span class="sc">&gt;</span><span class="fu">max</span>(x1))</span>
<span id="cb59-12"><a href="#cb59-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(out1,out2)<span class="sc">&gt;</span><span class="dv">5</span>)</span>
<span id="cb59-13"><a href="#cb59-13" tabindex="-1"></a>}</span>
<span id="cb59-14"><a href="#cb59-14" tabindex="-1"></a>permutation.count5.test<span class="ot">&lt;-</span><span class="cf">function</span>(x1,x2,N){</span>
<span id="cb59-15"><a href="#cb59-15" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">c</span>(x1,x2)</span>
<span id="cb59-16"><a href="#cb59-16" tabindex="-1"></a>  n1<span class="ot">&lt;-</span><span class="fu">length</span>(x1)</span>
<span id="cb59-17"><a href="#cb59-17" tabindex="-1"></a>  n2<span class="ot">&lt;-</span><span class="fu">length</span>(x2)</span>
<span id="cb59-18"><a href="#cb59-18" tabindex="-1"></a>  counter<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb59-19"><a href="#cb59-19" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb59-20"><a href="#cb59-20" tabindex="-1"></a>    index<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(n1<span class="sc">+</span>n2),<span class="at">size =</span> n1,<span class="at">replace =</span> F)</span>
<span id="cb59-21"><a href="#cb59-21" tabindex="-1"></a>    x0<span class="ot">&lt;-</span>z[index]</span>
<span id="cb59-22"><a href="#cb59-22" tabindex="-1"></a>    y0<span class="ot">&lt;-</span>z[<span class="sc">-</span>index]</span>
<span id="cb59-23"><a href="#cb59-23" tabindex="-1"></a>    counter[i]<span class="ot">&lt;-</span><span class="fu">count5.test</span>(x0,y0)</span>
<span id="cb59-24"><a href="#cb59-24" tabindex="-1"></a>  }</span>
<span id="cb59-25"><a href="#cb59-25" tabindex="-1"></a>  t0<span class="ot">&lt;-</span><span class="fu">count5.test</span>(x1,x2)</span>
<span id="cb59-26"><a href="#cb59-26" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">c</span>(t0,counter)))</span>
<span id="cb59-27"><a href="#cb59-27" tabindex="-1"></a>}</span>
<span id="cb59-28"><a href="#cb59-28" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231030</span>)</span>
<span id="cb59-29"><a href="#cb59-29" tabindex="-1"></a>pct<span class="ot">&lt;-</span><span class="fu">permutation.count5.test</span>(<span class="fu">rnorm</span>(n1,mu1,sigma1),<span class="fu">rnorm</span>(n2,mu2,sigma2),<span class="at">N =</span> <span class="dv">9999</span>)</span>
<span id="cb59-30"><a href="#cb59-30" tabindex="-1"></a>pct</span></code></pre></div>
<pre><code>## [1] 0.1458</code></pre>
</div>
</div>
</div>
<div id="homework-7" class="section level1">
<h1>Homework 7</h1>
<div id="questions-7" class="section level2">
<h2>Questions</h2>
<div id="exercise-1.-6" class="section level3">
<h3>Exercise 1.</h3>
<p>Consider a model <span class="math inline">\(P(Y = 1 | X_1, X_2, X_3)
=
\frac{\exp(a+b_1X_1+b_2X_2+b_3X_3)}{1+\exp(a+b_1X_1+b_2X_2+b_3X_3)}\)</span>,
where <span class="math inline">\(X_1 \sim P(1)\)</span>, <span class="math inline">\(X_2 \sim Exp(1)\)</span> and <span class="math inline">\(X_3 \sim B(1, 0.5)\)</span>.</p>
<ul>
<li>Design a function that takes as input values <span class="math inline">\(N\)</span>, <span class="math inline">\(b_1\)</span>, <span class="math inline">\(b_2\)</span>, <span class="math inline">\(b_3\)</span> and <span class="math inline">\(f_0\)</span>, and produces the output <span class="math inline">\(a\)</span>.</li>
<li>Call this function, input values are <span class="math inline">\(N =
10^6\)</span>, <span class="math inline">\(b_1 = 0\)</span>, <span class="math inline">\(b_2 = 1\)</span>, <span class="math inline">\(b_3
= -1\)</span>, <span class="math inline">\(f_0 = 0.1, 0.01, 0.001,
0.0001\)</span>.</li>
<li>Plot <span class="math inline">\(-\log f_0\)</span> vs <span class="math inline">\(a\)</span>.</li>
</ul>
</div>
<div id="exercise-9.4." class="section level3">
<h3>Exercise 9.4.</h3>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
</div>
<div id="exercise-9.7." class="section level3">
<h3>Exercise 9.7.</h3>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y = β_0 + β_1X\)</span> to the sample
and check the residuals of the model for normality and constant
variance.</p>
</div>
<div id="exercise-9.10." class="section level3">
<h3>Exercise 9.10.</h3>
<p>Refer to Example 9.1. Use the Gelman-Rubin method to monitor
convergence of the chain, and run the chain until the chain has
converged approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>. (See Exercise 9.9.)
Also use the coda [212] package to check for convergence of the chain by
the Gelman-Rubin method. Hints: See the help topics for the coda
functions <em>gelman.diag</em>, <em>gelman.plot</em>, <em>as.mcmc</em>,
and <em>mcmc.list</em>.</p>
</div>
</div>
<div id="answers-7" class="section level2">
<h2>Answers</h2>
<div id="exercise-1.-7" class="section level3">
<h3>Exercise 1.</h3>
<p>Suppose <span class="math inline">\(f_0=P(Y=1|X_1,X_2,X_3)\)</span>,
we have <span class="math display">\[f_0=\frac{1}{1+\exp(-(a+b_1X_1+b_2X_2+b_3X_3))}.\]</span>
Transform the equation and one has <span class="math display">\[a=-\log(\frac{1}{f_0}-1)-b_1X_1-b_2X_2-b_3X_3,\]</span>
If there is <span class="math inline">\(N\)</span> samples, the estimate
of <span class="math inline">\(a\)</span> is <span class="math display">\[\hat a=-\log(\frac{1}{f_0}-1)-b_1\bar X_1-b_2\bar
X_2-b_3\bar X_3,\]</span> where <span class="math inline">\(\bar
X\)</span> is the mean value of sample <span class="math inline">\(X\)</span>.</p>
<p>(1). The function is listed below.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>calcu.a<span class="ot">&lt;-</span><span class="cf">function</span>(N,b,f0){</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>  x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a>  x3<span class="ot">&lt;-</span><span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>  a.hat<span class="ot">&lt;-</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>f0<span class="dv">-1</span>)<span class="sc">-</span>b<span class="sc">%*%</span><span class="fu">c</span>(<span class="fu">mean</span>(x1),<span class="fu">mean</span>(x2),<span class="fu">mean</span>(x3))</span>
<span id="cb61-7"><a href="#cb61-7" tabindex="-1"></a>  <span class="fu">return</span>(a.hat)</span>
<span id="cb61-8"><a href="#cb61-8" tabindex="-1"></a>}</span></code></pre></div>
<p>(2). Take these value into the function, we have the values of <span class="math inline">\(a\)</span> in the table.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fl">1e6</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>f0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  a[i]<span class="ot">&lt;-</span><span class="fu">calcu.a</span>(N,b,f0[i])</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>}</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>f0_a<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">f0=</span>f0,<span class="at">a=</span>a)</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(f0_a,<span class="at">align =</span> <span class="st">&quot;cc&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">f0</th>
<th align="center">a</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1e-01</td>
<td align="center">-2.697342</td>
</tr>
<tr class="even">
<td align="center">1e-02</td>
<td align="center">-5.095964</td>
</tr>
<tr class="odd">
<td align="center">1e-03</td>
<td align="center">-7.407891</td>
</tr>
<tr class="even">
<td align="center">1e-04</td>
<td align="center">-9.709097</td>
</tr>
</tbody>
</table>
<p>(3). Take <span class="math inline">\(N=10000\)</span> and <span class="math inline">\(f_0=0.0001, 0.0101, 0.0201,\cdots,0.9901\)</span>,
one has:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>f0<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">1e-4</span>,<span class="dv">1</span>,<span class="fl">1e-2</span>)</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(f0))</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f0)){</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>  a[i]<span class="ot">&lt;-</span><span class="fu">calcu.a</span>(N,b,f0[i])</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>}</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f0),a,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-9.4.-1" class="section level3">
<h3>Exercise 9.4.</h3>
<p>By Exercise 3.2, the standard Laplace distribution is <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}\)</span>. Take the normal
distribution as the proposal distribution, the random walk Metropolis
sampler can be applied by the following steps.</p>
<ul>
<li>Take the initial value <span class="math inline">\(X_1\leftarrow
x_0\)</span> and acceptance count <span class="math inline">\(k\leftarrow 0\)</span>.</li>
<li>For <span class="math inline">\(i=2,\cdots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(U\sim U(0,1)\)</span> and <span class="math inline">\(Y\sim N(X_{i-1},\sigma^2)\)</span></li>
<li><span class="math inline">\(X_{i}\leftarrow Y\)</span> and update
the acceptance count <span class="math inline">\(k\leftarrow
k+1\)</span> if <span class="math inline">\(U&lt;\frac{f(Y)}{f(X_{i-1})}\)</span>, otherwise
<span class="math inline">\(X_{i}\leftarrow X_{i-1}\)</span>.</li>
</ul></li>
</ul>
<p>By denoting <span class="math inline">\(\sigma=0.5,1,2,5\)</span>, we
have the following results.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>  <span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>}</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>rw.Metroplis<span class="ot">&lt;-</span><span class="cf">function</span>(N,x0,sigma){</span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span>x0</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">runif</span>(N)</span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a>    <span class="cf">if</span>(U[i] <span class="sc">&lt;</span> <span class="fu">f</span>(y)<span class="sc">/</span><span class="fu">f</span>(x[i<span class="dv">-1</span>])){</span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>      x[i]<span class="ot">&lt;-</span>y</span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a>      k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a>    }</span>
<span id="cb64-16"><a href="#cb64-16" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb64-17"><a href="#cb64-17" tabindex="-1"></a>      x[i]<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>]</span>
<span id="cb64-18"><a href="#cb64-18" tabindex="-1"></a>    }</span>
<span id="cb64-19"><a href="#cb64-19" tabindex="-1"></a>  }</span>
<span id="cb64-20"><a href="#cb64-20" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">k=</span>k))</span>
<span id="cb64-21"><a href="#cb64-21" tabindex="-1"></a>}</span>
<span id="cb64-22"><a href="#cb64-22" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">3000</span></span>
<span id="cb64-23"><a href="#cb64-23" tabindex="-1"></a>x0<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb64-24"><a href="#cb64-24" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>)</span>
<span id="cb64-25"><a href="#cb64-25" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb64-26"><a href="#cb64-26" tabindex="-1"></a>rw1<span class="ot">&lt;-</span><span class="fu">rw.Metroplis</span>(N,x0,sigma[<span class="dv">1</span>])</span>
<span id="cb64-27"><a href="#cb64-27" tabindex="-1"></a>rw2<span class="ot">&lt;-</span><span class="fu">rw.Metroplis</span>(N,x0,sigma[<span class="dv">2</span>])</span>
<span id="cb64-28"><a href="#cb64-28" tabindex="-1"></a>rw3<span class="ot">&lt;-</span><span class="fu">rw.Metroplis</span>(N,x0,sigma[<span class="dv">3</span>])</span>
<span id="cb64-29"><a href="#cb64-29" tabindex="-1"></a>rw4<span class="ot">&lt;-</span><span class="fu">rw.Metroplis</span>(N,x0,sigma[<span class="dv">4</span>])</span>
<span id="cb64-30"><a href="#cb64-30" tabindex="-1"></a>reject_p<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">sigma=</span>sigma,<span class="at">No.accept=</span><span class="fu">c</span>(rw1<span class="sc">$</span>k,rw2<span class="sc">$</span>k,rw3<span class="sc">$</span>k,rw4<span class="sc">$</span>k),<span class="at">P_accept=</span><span class="fu">c</span>(rw1<span class="sc">$</span>k,rw2<span class="sc">$</span>k,rw3<span class="sc">$</span>k,rw4<span class="sc">$</span>k)<span class="sc">/</span>N)</span>
<span id="cb64-31"><a href="#cb64-31" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(reject_p,<span class="at">align =</span> <span class="st">&#39;ccc&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">sigma</th>
<th align="center">No.accept</th>
<th align="center">P_accept</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.5</td>
<td align="center">2497</td>
<td align="center">0.8323333</td>
</tr>
<tr class="even">
<td align="center">1.0</td>
<td align="center">2113</td>
<td align="center">0.7043333</td>
</tr>
<tr class="odd">
<td align="center">2.0</td>
<td align="center">1599</td>
<td align="center">0.5330000</td>
</tr>
<tr class="even">
<td align="center">5.0</td>
<td align="center">870</td>
<td align="center">0.2900000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="co"># par(mfrow = c(2,2))</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a><span class="fu">plot</span>(rw1<span class="sc">$</span>x,<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;X&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">plot</span>(rw2<span class="sc">$</span>x,<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;X&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">plot</span>(rw3<span class="sc">$</span>x,<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;X&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">plot</span>(rw4<span class="sc">$</span>x,<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;X&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-9.7.-1" class="section level3">
<h3>Exercise 9.7.</h3>
<p>For bivariate normal distribution <span class="math inline">\((X_t,Y_t)\sim
N(\mu_1,\mu_2,\sigma_1,\sigma_2,\rho)\)</span>, the Gibbs sampler can be
performed by the following steps.</p>
<ul>
<li>Take the initial value <span class="math inline">\(X_0:=(X_0^1,X_0^2)=(x_0^1,x_0^2)\)</span>.</li>
<li>For <span class="math inline">\(i=1,\cdots,N\)</span>:
<ul>
<li>Update <span class="math inline">\(X_i^1=(X_1|X_2=X_{i-1}^2)\sim
N(\mu_1+\rho\sigma_1/\sigma_2(X_{i-1}^2-\mu_2),(1-\rho^2)\sigma_1^2)\)</span>.</li>
<li>Update <span class="math inline">\(X_i^2=(X_2|X_1=X_{i}^2)\sim
N(\mu_2+\rho\sigma_2/\sigma_1(X_{i}^1-\mu_1),(1-\rho^2)\sigma_2^2)\)</span>.</li>
</ul></li>
</ul>
<p>The samples generated after discarding burn-in samples are plotted
below.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>Gibbs<span class="ot">&lt;-</span><span class="cf">function</span>(N,x,<span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">sigma =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">rho =</span> <span class="fl">0.9</span>){</span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> N<span class="sc">+</span><span class="dv">1</span>,<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>  X[<span class="dv">1</span>,]<span class="ot">&lt;-</span>x</span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(N<span class="sc">+</span><span class="dv">1</span>)){</span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>    X[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,mu[<span class="dv">1</span>]<span class="sc">+</span>rho<span class="sc">*</span>sigma[<span class="dv">1</span>]<span class="sc">/</span>sigma[<span class="dv">2</span>]<span class="sc">*</span>(X[i<span class="dv">-1</span>,<span class="dv">2</span>]<span class="sc">-</span>mu[<span class="dv">2</span>]),(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>    X[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,mu[<span class="dv">2</span>]<span class="sc">+</span>rho<span class="sc">*</span>sigma[<span class="dv">2</span>]<span class="sc">/</span>sigma[<span class="dv">1</span>]<span class="sc">*</span>(X[i,<span class="dv">1</span>]<span class="sc">-</span>mu[<span class="dv">1</span>]),(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a>  }</span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a>  <span class="fu">return</span>(X[<span class="sc">-</span><span class="dv">1</span>,])</span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a>}</span>
<span id="cb69-11"><a href="#cb69-11" tabindex="-1"></a>burn<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb69-12"><a href="#cb69-12" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">3000</span></span>
<span id="cb69-13"><a href="#cb69-13" tabindex="-1"></a>x0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb69-14"><a href="#cb69-14" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">Gibbs</span>(N,x0)[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn),]</span>
<span id="cb69-15"><a href="#cb69-15" tabindex="-1"></a><span class="fu">plot</span>(data[,<span class="dv">1</span>],<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">col =</span> <span class="dv">1</span>,<span class="at">lwd =</span> <span class="dv">1</span>,<span class="at">ylab =</span> <span class="st">&quot;Xt, Yt&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Burn = 1000&quot;</span>)</span>
<span id="cb69-16"><a href="#cb69-16" tabindex="-1"></a><span class="fu">lines</span>(data[,<span class="dv">2</span>],<span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb69-17"><a href="#cb69-17" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;Xt&quot;</span>,<span class="st">&quot;Yt&quot;</span>),<span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">cex =</span> <span class="fl">0.8</span>,<span class="at">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Using the left samples to fit the linear regression, the residuals
plot can be obtained.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>reg<span class="ot">&lt;-</span><span class="fu">data.frame</span>(data)</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a><span class="fu">colnames</span>(reg)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Xt&quot;</span>,<span class="st">&quot;Yt&quot;</span>)</span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">lm</span>(Yt <span class="sc">~</span> Xt,<span class="at">data =</span> reg)</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a><span class="fu">plot</span>(model,<span class="at">which=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the figures, the residuals of the model have constant variance
and good normality.</p>
</div>
<div id="exercise-9.10.-1" class="section level3">
<h3>Exercise 9.10.</h3>
<p><span class="math inline">\(f(x)=\frac{x}{\sigma^2}e^{-\frac{x^2}{2\sigma^2}}\)</span>,
denote the initial value <span class="math inline">\(x_0=1,4,9,16\)</span>. The Metropolis-Hastings
sampler will be applied below. For each <span class="math inline">\(j\)</span> greater than burn-in length, calculate
the Gelman-Rubin statistic.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x,sigma){</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(x<span class="sc">&lt;</span><span class="dv">0</span>))</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>  <span class="fu">stopifnot</span>(sigma<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>}</span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>MH.sampler<span class="ot">&lt;-</span><span class="cf">function</span>(N,x0,sigma){</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a>  X[<span class="dv">1</span>]<span class="ot">&lt;-</span>x0</span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">runif</span>(N)</span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a>    Y<span class="ot">&lt;-</span><span class="fu">rchisq</span>(<span class="dv">1</span>,<span class="at">df =</span> X[i<span class="dv">-1</span>])</span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a>    r1<span class="ot">&lt;-</span><span class="fu">f</span>(Y,sigma)<span class="sc">*</span><span class="fu">dchisq</span>(X[i<span class="dv">-1</span>],<span class="at">df=</span>Y)</span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a>    r2<span class="ot">&lt;-</span><span class="fu">f</span>(X[i<span class="dv">-1</span>],sigma)<span class="sc">*</span><span class="fu">dchisq</span>(Y,<span class="at">df=</span>X[i<span class="dv">-1</span>])</span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a>    alpha<span class="ot">&lt;-</span>r1<span class="sc">/</span>r2</span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a>    <span class="cf">if</span>(U[i] <span class="sc">&lt;=</span> alpha){</span>
<span id="cb71-18"><a href="#cb71-18" tabindex="-1"></a>      X[i]<span class="ot">&lt;-</span>Y</span>
<span id="cb71-19"><a href="#cb71-19" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb71-20"><a href="#cb71-20" tabindex="-1"></a>      X[i]<span class="ot">&lt;-</span>X[i<span class="dv">-1</span>]</span>
<span id="cb71-21"><a href="#cb71-21" tabindex="-1"></a>    }</span>
<span id="cb71-22"><a href="#cb71-22" tabindex="-1"></a>  }</span>
<span id="cb71-23"><a href="#cb71-23" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb71-24"><a href="#cb71-24" tabindex="-1"></a>}</span>
<span id="cb71-25"><a href="#cb71-25" tabindex="-1"></a>GR.statistic<span class="ot">&lt;-</span><span class="cf">function</span>(phi){</span>
<span id="cb71-26"><a href="#cb71-26" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">ncol</span>(phi)</span>
<span id="cb71-27"><a href="#cb71-27" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="fu">nrow</span>(phi)</span>
<span id="cb71-28"><a href="#cb71-28" tabindex="-1"></a>  Bn<span class="ot">&lt;-</span>N<span class="sc">/</span>(k<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sum</span>((<span class="fu">rowMeans</span>(phi)<span class="sc">-</span><span class="fu">mean</span>(phi))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb71-29"><a href="#cb71-29" tabindex="-1"></a>  Wn<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span>k<span class="sc">/</span>N<span class="sc">*</span><span class="fu">sum</span>((phi<span class="sc">-</span><span class="fu">rowMeans</span>(phi))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb71-30"><a href="#cb71-30" tabindex="-1"></a>  Var.phi<span class="ot">&lt;-</span>(N<span class="dv">-1</span>)<span class="sc">/</span>N<span class="sc">*</span>Wn<span class="sc">+</span>Bn<span class="sc">/</span>N</span>
<span id="cb71-31"><a href="#cb71-31" tabindex="-1"></a>  R<span class="ot">&lt;-</span>Var.phi<span class="sc">/</span>Wn</span>
<span id="cb71-32"><a href="#cb71-32" tabindex="-1"></a>  <span class="fu">return</span>(R)</span>
<span id="cb71-33"><a href="#cb71-33" tabindex="-1"></a>}</span>
<span id="cb71-34"><a href="#cb71-34" tabindex="-1"></a>burn<span class="ot">&lt;-</span><span class="dv">2000</span></span>
<span id="cb71-35"><a href="#cb71-35" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">15000</span></span>
<span id="cb71-36"><a href="#cb71-36" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb71-37"><a href="#cb71-37" tabindex="-1"></a>x0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">9</span>,<span class="dv">16</span>)</span>
<span id="cb71-38"><a href="#cb71-38" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">length</span>(x0)</span>
<span id="cb71-39"><a href="#cb71-39" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,k,N)</span>
<span id="cb71-40"><a href="#cb71-40" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb71-41"><a href="#cb71-41" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb71-42"><a href="#cb71-42" tabindex="-1"></a>  X[i,]<span class="ot">&lt;-</span><span class="fu">MH.sampler</span>(N,x0[i],sigma)</span>
<span id="cb71-43"><a href="#cb71-43" tabindex="-1"></a>}</span>
<span id="cb71-44"><a href="#cb71-44" tabindex="-1"></a>phi<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">apply</span>(X,<span class="dv">1</span>,cumsum))</span>
<span id="cb71-45"><a href="#cb71-45" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb71-46"><a href="#cb71-46" tabindex="-1"></a>  phi[i,]<span class="ot">&lt;-</span>phi[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb71-47"><a href="#cb71-47" tabindex="-1"></a>GR.hat<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb71-48"><a href="#cb71-48" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N){</span>
<span id="cb71-49"><a href="#cb71-49" tabindex="-1"></a>  GR.hat[j]<span class="ot">&lt;-</span><span class="fu">GR.statistic</span>(phi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb71-50"><a href="#cb71-50" tabindex="-1"></a>}</span>
<span id="cb71-51"><a href="#cb71-51" tabindex="-1"></a><span class="co"># par(mfrow = c(2,2))</span></span>
<span id="cb71-52"><a href="#cb71-52" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb71-53"><a href="#cb71-53" tabindex="-1"></a>  <span class="fu">plot</span>(phi[i,(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb71-54"><a href="#cb71-54" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co"># par(mfrow = c(1,1))</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a><span class="fu">plot</span>((burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,GR.hat[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn)],<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;GR&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;index&quot;</span>)</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>,<span class="at">col =</span> <span class="st">&quot;red&quot;</span>,<span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the figure, the chain converged when the iteration was beyond
3000. The <em>coda</em> package used to diagnose the chain also shows
its convergence.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>XX<span class="ot">&lt;-</span>X[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn)]</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">as.mcmc</span>(XX[<span class="dv">1</span>,])</span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">as.mcmc</span>(XX[<span class="dv">2</span>,])</span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">as.mcmc</span>(XX[<span class="dv">3</span>,])</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a>x4<span class="ot">&lt;-</span><span class="fu">as.mcmc</span>(XX[<span class="dv">4</span>,])</span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="fu">mcmc.list</span>(x1,x2,x3,x4)</span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a><span class="fu">gelman.diag</span>(M)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1          1</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">gelman.plot</span>(M)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAbFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmkJBmtrZmtv+QOgCQOjqQOmaQZgCQkGaQkNuQ2/+2ZgC225C2/7a2///bkDrb/7bb///fU2v/tmb/25D//7b//9v///+yL39UAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJKUlEQVR4nO2di5abNhRFmWnstHZaT9vUpKEJtvn/f6ykK8kYRhwe4mHN2WslwaBIZiOuhJAhq0gn2dpfYOtQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBAZEHZ07CWoLjZzQcFASgIsK6gn3EznQMKAlAQgIIAFARgKwagIAAFARiDAMMF3d4O0cpNUtD1eIpWbpKCqvL1e7Ryt29oTA2yAyWTPCUsaOFy14aCAGMEXfbqBHs5L1PujJQvZ9zijAnSmW7ni2xSY7aFGFT2Ocjj+0HFpx8jvlQjuxQFuVo5rbVfStBl/4dqdQ86KuivXajgYI6vWnj56k6xPDNbr0edtnFipF6DLntVTQrdJSn0H/XhslffP1cfyswKyneV2XI96rSNavWUMWjAfSyjw/51uh71N1dVXy2rhVwEXb+czdbKbJZNrS/ae4+k0NGt2PD7cRMx++v+kqCjF0x4qLVipT61zIdmu5Z6P+hRkD04p+JBkIpHr9/20QSZGllFCtKz804Nqtx3t4J8ksiCiidpxWqC/M5LoClEkLFVxjrF8nsUmTQstIogaaJy21a5Vkwqj9qdyDVoGusIMv0gU/Pr/SC9fLZN2taCdJrDHbnqIpbTzrCkBeWmC3097hYpd21WvhbbPhOuxSgokFCuwsz1zeRyk4xBMUcU0xQUsdwFBBVyMP11mFkpt2Z25mDrNuf2FhqbWPtidXZDuRkCsrvvm97LZzkBVEC9val1ZbBJHiHI3RiLEqTnFiRDQG5wzzcsrgnWotTG25/BgDGuH1TsWgNLA1mqFZMLeHsZf29YilpNUoLCFWhUP+hQleqI9Bhy7ZC4sCAJPbmv9PlvcrVtTrFDRwUa2VG8/Prd/Ang706HT8RJgn5qOv6tYQc2jCA53eQL6qObH2yQ7qhAIzuK+oq+Q5C7UutRgxYK0kZQ8zaPC0SqAqlDOvVI1jqKKislv/MUk0O0BUF6BOv1XzNEkze+sft6qgLlu9ZWy6ir+V0VNu4T1ZvXcHbL9BRNbb+fYW6ttPWmAh1C15bz9YMKfbtuI4KKRn2WRauk3FXxBKkI3XtE8bL/ZX1Bpmv40NYb9L1CE6RNBarinWJKdf8h19tb+ObiYlfzukUVM7aXaHrO7m5zZbtE8YJ0ARvwQdltn7kH7UOjRgkLmlZc89bz5sc7kr+anwoFASgIMCJI/yP/3v56hvGgyYwb7qj09Wi4mZ/7an5JRs4wUwq67hve3lAnKWVBZvwbCJDuaoxy12ZUkO5xY74EUxgTjkEatPv9s0tNUI/wO6zc1ATFL3frhigIMELQ7Y3DHZ0J80lmhpa7NqN70kuVuzbjZ5hFKje9GAQ7ycOyS09QhF5ilbSgqD8LT1FQzHIzCurO7gnaMgoCjLizGjEGpScodrlZgjEo5vODkhQUtSedoqCozw9KUdCkIN28N5+ioKjlbr8ZoyDAyiOKSQqKOqK4+SC09ohikoJijigmKCjuiGKCgqb+EOoxu9QERb/1vPlmbO07qxQEsktRkG7niyyb9Iy3e3ZZWjFIk3/6cdnv5Pcg08tNT5B5aFN2ivXsjjQF5fa5hBHKTU+QOrf0Dy5jPR5n6x2hUUE6ezmD/jS84s9aCxtlnma+cNNgg/NhP7ag2o2P0G+jP7ag2gV/qK3L6ktbjkKr16C7oG1qmisG2SqEY5BZ+llt1c9c12Luqj94PfK+oA1KWvtiVS+ak2yrp9kGBPmpHq4ubYq5BfX7Wbhyo/XoG67ymJteeXc8FSceC9eg7PlYVtBc2c0HBQEoCEBBgJmuxe4xLtSKPQ1zCOrxs/DuTGOtj5cRZth/7Xl/+uMK6vmLlw8saFqmFAQypSCQKQWBTCkIZEpBIFMKShAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEiC+o7PWaO3mbg0/bXsDYl+x05DEgsyDRBenXXDTftvNOKjMHy6dtL2CuR/fq61AeAzILE1uQzGNEP/i4HrUgn7a9gCnl5mVHHgMy6yC2IPteK3CDsfj0txLk07YXYDlldjAzbTvy6J9ZF9EFmTcPgV/EqEQ6Bvm07YU+RYmgcB6DMgsSW1D7fTttdN03L5Z2adsLvYoyL5QP5zEosyBrCNKTrD+soB712iT5sKdYj8joXrR0mhhXnzNI921b86nNvBX0dM18395ZPrmjaE+eZ+so+pcwA+RSw6dtL2BsdOnIY0BmQXixCqAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBZhX07rs6ytN9Wxl+0IXaFHzVR2hDa32El4UsLqi+ruP7j9q1OC9PeYSCAPMLyvVkskrPBZNZZfY5nmqbXdYzzg5qxZeveuazJDeb/jP7W9rNxz+OWXY/PeufZdbaTq37fS/rbKHthIOZXZCe4VW8nGWuXJmd3FGW735yGw+Vfh565ZP7zfqBPPox6dejWlvIdB/ZeP9s/8fBr3vMpZZwOHMLun45y0RCN5myKUjeSqW2mgWf3G2WeXTly9lstq/X8f/Pfz5U/l+1rpHLYcp7eZaIQWVmaoEYagqSOXJ6r1wAscnlj+yZ22zT+OplP7vdr697yGVCdJpdkIoOr9/0Dpjn4Z/agtycV9ngkj8K0lWxS9Dns8/zodAnEGR20FfwXJ8q79Ugu6LyySfVoFYuGxYk0+FdI+JqQlWPQfdtbvZ89m4MCgu6x6DTY6FPIEiOo2qn3cTc+s6YZdPAuKrlk+tNjVYsLMjkcXvb1WuQzWXzgmQqbq5nLGcyKTf3/SC7rPsw6pD7GCTJ81Y/qEOQ7wedHgvduqAUoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAP8Dn70JlxEjAwgAAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
</div>
<div id="homework-8" class="section level1">
<h1>Homework 8</h1>
<div id="questions-8" class="section level2">
<h2>Questions</h2>
<div id="exercise-1.-8" class="section level3">
<h3>Exercise 1.</h3>
<p>设<span class="math inline">\(X_1,\cdots,X_n\sim
Exp(\lambda)\)</span>.因为某种原因，只知道<span class="math inline">\(X_i\)</span>落在某个区间<span class="math inline">\((u_1,v_i)\)</span>，其中<span class="math inline">\(u_i&lt;v_i\)</span>是两个非随机的已知常数，这种数据称为区间删失数据。</p>
<p>(1). 试分别直接极大化观测数据的似然函数与采用EM算法求解<span class="math inline">\(\lambda\)</span>的MLE，证明EM算法收敛于观测数据的MLE，且收敛有线性速度。</p>
<p>(2). 设<span class="math inline">\((u_i,v_i),
i=1,\cdots,n(=10)\)</span>的观测值为(11,12), (8,9), (27,28), (13,14),
(16,17), (0,1), (23,24), (10,11), (24,25),
(2,3).试分别编程实现上述两种算法以得到<span class="math inline">\(\lambda\)</span>的MLE的数值解。</p>
<p>提示：观测数据的似然函数为<span class="math inline">\(L(\lambda)=\prod_{i=1}^nP_\lambda(u_i\le X_i\le
v_i)\)</span>.</p>
</div>
<div id="exercise-11.8." class="section level3">
<h3>Exercise 11.8.</h3>
<p>In the Morra game, the set of optimal strategies are not changed if a
constant is subtracted from every entry of the payoff matrix, or a
positive constant is multiplied times every entry of the payoff matrix.
However, the simplex algorithm may terminate at a different basic
feasible point (also optimal). Compute <span class="math inline">\(B
&lt;- A + 2\)</span>, find the solution of game <span class="math inline">\(B\)</span>, and verify that it is one of the
extreme points (11.12)–(11.15) of the original game <span class="math inline">\(A\)</span>. Also find the value of game <span class="math inline">\(A\)</span> and game <span class="math inline">\(B\)</span>.</p>
</div>
</div>
<div id="answers-8" class="section level2">
<h2>Answers</h2>
<div id="exercise-1.-9" class="section level3">
<h3>Exercise 1.</h3>
<p>(1). For <span class="math inline">\(X\sim Exp(\lambda)\)</span>, the
density function of <span class="math inline">\(X\)</span> is <span class="math display">\[f(x)=\lambda e^{-\lambda x},~~x\ge 0.\]</span>
Thus, we have <span class="math display">\[P_\lambda(u_i\le X\le
v_i)=\int_{u_i}^{v_i}\lambda e^{-\lambda x}dx=e^{-\lambda
u_i}-e^{-\lambda v_i}.\]</span></p>
<div id="mle-of-lambda." class="section level4">
<h4>MLE of <span class="math inline">\(\lambda\)</span>.</h4>
<p>The likelihood function is <span class="math display">\[L(\lambda)=\prod_{i=1}^n\left(e^{-\lambda
u_i}-e^{-\lambda v_i}\right).\]</span> The log likelihood function is
<span class="math display">\[\log
L(\lambda)=\sum_{i=1}^n\log\left(e^{-\lambda u_i}-e^{-\lambda
v_i}\right).\]</span> Take the derivation of <span class="math inline">\(\lambda\)</span> and let it be zero, that is,
<span class="math display">\[\frac{d}{d\lambda}\log
L(\lambda)=-\sum_{i=1}^n\frac{u_ie^{-\lambda u_i}-v_ie^{-\lambda
v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}=0.\]</span></p>
<p>Denote the solution of the above equation as <span class="math inline">\(\lambda_\infty\)</span>.</p>
</div>
<div id="the-em-algorithm." class="section level4">
<h4>The EM algorithm.</h4>
<p>Suppose the true observation data is <span class="math inline">\(X=(x_1,\cdots,x_n)\)</span>. The log likelihood
function is <span class="math display">\[\log L(\lambda)
=\log\prod_{i=1}^n\lambda e^{-\lambda
x_i}=n\log\lambda-\lambda\sum_{i=1}^nx_i.\]</span></p>
<p>The E step, the Q function is <span class="math display">\[Q=E[\log
L(\lambda)|\pmb u,\pmb
v,\lambda^{(n)}]=n\log\lambda-\lambda\sum_{i=1}^nE[x_i|\pmb u,\pmb
v,\lambda^{(n)}].\]</span></p>
<p>Note that <span class="math inline">\(P(x_i|u_i,v_i,\lambda^{(n)})=\frac{\lambda
e^{-\lambda x_i}}{P(u_i\le x_i\le v_i)}\)</span>, thus one has <span class="math display">\[E[x_i|\pmb u,\pmb
v,\lambda^{(n)}]=\frac{\int_{u_i}^{v_i}x\lambda^{(n)} e^{-\lambda^{(n)}
x}dx}{P(u_i\le x_i\le v_i)}=\frac{u_ie^{-\lambda^{(n)}
u_i}-v_ie^{-\lambda^{(n)} v_i}}{e^{-\lambda^{(n)} u_i}-e^{-\lambda^{(n)}
v_i}}+\frac{1}{\lambda^{(n)}}.\]</span></p>
<p>The M step, take the derivation of <span class="math inline">\(\lambda\)</span> and let it be zero, that is,
<span class="math display">\[\frac{d}{d\lambda}E[\log
L(\lambda)]=\frac{n}{\lambda}-\sum_{i=1}^nE[x_i|\pmb u,\pmb
v,\lambda^{(n)}]=0.\]</span></p>
<p>The iterative expression of <span class="math inline">\(\lambda\)</span> is <span class="math display">\[\lambda^{(n+1)}=\frac{n}{\sum_{i=1}^n\frac{u_ie^{-\lambda^{(n)}
u_i}-v_ie^{-\lambda^{(n)} v_i}}{e^{-\lambda^{(n)} u_i}-e^{-\lambda^{(n)}
v_i}}+\frac{n}{\lambda^{(n)}}}.\]</span></p>
</div>
<div id="proof-of-linear-convergence-speed." class="section level4">
<h4>Proof of linear convergence speed.</h4>
<p>Take the reciprocal of the iterative expression of <span class="math inline">\(\lambda^{(n+1)}\)</span>, that is, <span class="math display">\[\frac{1}{\lambda^{(n+1)}}=\frac{1}{n}\sum_{i=1}^n\frac{u_ie^{-\lambda^{(n)}
u_i}-v_ie^{-\lambda^{(n)} v_i}}{e^{-\lambda^{(n)} u_i}-e^{-\lambda^{(n)}
v_i}}+\frac{1}{\lambda^{(n)}}.\]</span></p>
<p>Denote <span class="math inline">\(g_i(\lambda^{(n)})=\frac{u_ie^{-\lambda^{(n)}
u_i}-v_ie^{-\lambda^{(n)} v_i}}{e^{-\lambda^{(n)} u_i}-e^{-\lambda^{(n)}
v_i}}\)</span> and <span class="math inline">\(x_{n}=\frac{1}{\lambda^{(n)}}\)</span>, <span class="math inline">\(f(x)=\frac{1}{n}\sum_{i=1}^ng_i(\frac{1}{x})+x\)</span>.</p>
<p>Note that <span class="math display">\[
\begin{align}
g_i(\lambda^{(n)}) &amp; = \frac{u_ie^{-\lambda^{(n)}
u_i}-v_ie^{-\lambda^{(n)} v_i}}{e^{-\lambda^{(n)} u_i}-e^{-\lambda^{(n)}
v_i}}\nonumber\\
&amp; =
\frac{\left(u_ie^{-\lambda^{(n)}u_i}-u_ie^{-\lambda^{(n)}v_i}\right)+\left(v_ie^{-\lambda^{(n)}u_i}-v_ie^{-\lambda^{(n)}v_i}\right)+u_ie^{-\lambda^{(n)}v_i}-v_ie^{-\lambda^{(n)}u_i}}{e^{-\lambda^{(n)}
u_i}-e^{-\lambda^{(n)} v_i}}\nonumber\\
&amp; = u_i + v_i +
\frac{u_ie^{-\lambda^{(n)}v_i}-v_ie^{-\lambda^{(n)}u_i}}{e^{-\lambda^{(n)}
u_i}-e^{-\lambda^{(n)} v_i}}.\nonumber
\end{align}
\]</span></p>
<p>We will prove the EM algorithm converges to MLE at a linear speed. It
is easy to prove that <span class="math inline">\(x_\infty=\frac{1}{\lambda_\infty}\)</span> is a
fixed point of <span class="math inline">\(f(\lambda)\)</span>. Now we
consider the convergence speed.</p>
<p><span class="math display">\[\frac{|x_{n+1}-x_\infty|}{|x_{n}-x_\infty|}=\frac{|f(x_{n})-f(x_\infty)|}{|x_{n}-x_\infty|}=\frac{|f^\prime(x_\infty)|\cdot|x_{n}-x_\infty|(1+o(1))}{|x_{n}-x_\infty|}=|f^\prime(x_\infty)|(1+o(1)).\]</span></p>
<p>Consider <span class="math inline">\(\alpha=|f^\prime(x_\infty)|\in(0,\infty)\)</span>.
<span class="math display">\[|f^\prime(x_\infty)| =
\left|\frac{1}{n}\sum_{i=1}^ng_i^\prime\left(\frac{1}{x_\infty}\right)+1\right|\le\frac{1}{n}\sum_{i=1}^n\left|g_i^\prime\left(\frac{1}{x_\infty}\right)\right|+1,\]</span>
where <span class="math inline">\(n\)</span> is the sample size. <span class="math display">\[
\begin{align}
g_i^\prime(\lambda) &amp; = \frac{1}{(e^{-\lambda u_i}-e^{-\lambda
v_i})^2}\left[u_iv_i(e^{-\lambda u_i}-e^{-\lambda
v_i})^2+(u_ie^{-\lambda u_i}-v_ie^{-\lambda v_i})^2\right]\nonumber\\
&amp; = u_iv_i+g_i^2(\lambda).\nonumber
\end{align}
\]</span></p>
<p>Besides, <span class="math display">\[g_i(\lambda)=\frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}\le\frac{v_ie^{-\lambda u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda
u_i}-e^{-\lambda v_i}}=v_i.\]</span></p>
<p>So we have <span class="math display">\[|f^\prime(x_\infty)|\le\frac{1}{n}\sum_{i=1}^n\left|g_i^\prime\left(\frac{1}{x_\infty}\right)\right|+1=\frac{1}{n}\sum_{i=1}^n(u_iv_i+g_i^2(\lambda))+1\le\frac{1}{n}\sum_{i=1}^n(u_iv_i+v_i^2)+1\in(0,\infty).\]</span></p>
<p>The EM algorithm converges to MLE at a linear speed holds.</p>
<p>(2).</p>
<p>By MLE:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="fu">library</span>(stats4)</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a><span class="co"># MLE</span></span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>mlogL <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">lambda =</span> <span class="dv">1</span>){</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span><span class="fu">sum</span>(<span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))))</span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>}</span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">mle</span>(mlogL)</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>fit<span class="sc">@</span>coef</span></code></pre></div>
<pre><code>##    lambda 
## 0.0719775</code></pre>
<p>By the EM algorithm.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a><span class="co"># EM</span></span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(u)</span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>lam0 <span class="ot">&lt;-</span> .<span class="dv">1</span></span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>lam1 <span class="ot">&lt;-</span> .<span class="dv">2</span></span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">1e-8</span></span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a><span class="cf">repeat</span>{</span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a>  lam1 <span class="ot">&lt;-</span> n <span class="sc">/</span> (<span class="fu">sum</span>((u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam0<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam0<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lam0<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lam0<span class="sc">*</span>v)))<span class="sc">+</span>n <span class="sc">/</span> lam0)</span>
<span id="cb78-12"><a href="#cb78-12" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">abs</span>(lam0 <span class="sc">-</span> lam1) <span class="sc">&lt;</span> eps){</span>
<span id="cb78-13"><a href="#cb78-13" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb78-14"><a href="#cb78-14" tabindex="-1"></a>  }</span>
<span id="cb78-15"><a href="#cb78-15" tabindex="-1"></a>  lam0 <span class="ot">&lt;-</span> lam1</span>
<span id="cb78-16"><a href="#cb78-16" tabindex="-1"></a>  k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb78-17"><a href="#cb78-17" tabindex="-1"></a>}</span>
<span id="cb78-18"><a href="#cb78-18" tabindex="-1"></a>lam1</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
<p>Thus, the numerical solution of <span class="math inline">\(\lambda\)</span> is 0.0719735.</p>
</div>
</div>
<div id="exercise-11.8.-1" class="section level3">
<h3>Exercise 11.8.</h3>
<p>Using the function and the payoff matrix <span class="math inline">\(A\)</span> proposed in Example 11.17. Denoting
<span class="math inline">\(B = A+2\)</span>, we can obtain the
strategies of player 1 and 2 and the value of game <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>  ori.A <span class="ot">&lt;-</span> A</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>  A <span class="ot">&lt;-</span> (A <span class="sc">-</span> <span class="fu">min</span>(A))<span class="sc">/</span><span class="fu">max</span>(A)</span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>  it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>)</span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n))</span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>)))</span>
<span id="cb80-12"><a href="#cb80-12" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb80-13"><a href="#cb80-13" tabindex="-1"></a>  sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3, <span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb80-14"><a href="#cb80-14" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>)</span>
<span id="cb80-15"><a href="#cb80-15" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m))</span>
<span id="cb80-16"><a href="#cb80-16" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb80-17"><a href="#cb80-17" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>)))</span>
<span id="cb80-18"><a href="#cb80-18" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb80-19"><a href="#cb80-19" tabindex="-1"></a>  sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb80-20"><a href="#cb80-20" tabindex="-1"></a>                <span class="at">maxi=</span><span class="cn">FALSE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb80-21"><a href="#cb80-21" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> <span class="fu">max</span>(ori.A) <span class="sc">+</span> <span class="fu">min</span>(ori.A),</span>
<span id="cb80-22"><a href="#cb80-22" tabindex="-1"></a>               <span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb80-23"><a href="#cb80-23" tabindex="-1"></a>               <span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb80-24"><a href="#cb80-24" tabindex="-1"></a>               <span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> <span class="fu">max</span>(ori.A) <span class="sc">+</span> <span class="fu">min</span>(ori.A))</span>
<span id="cb80-25"><a href="#cb80-25" tabindex="-1"></a>  solution</span>
<span id="cb80-26"><a href="#cb80-26" tabindex="-1"></a>}</span>
<span id="cb80-27"><a href="#cb80-27" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb80-28"><a href="#cb80-28" tabindex="-1"></a>               <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb80-29"><a href="#cb80-29" tabindex="-1"></a>               <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb80-30"><a href="#cb80-30" tabindex="-1"></a>               <span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb80-31"><a href="#cb80-31" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb80-32"><a href="#cb80-32" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb80-33"><a href="#cb80-33" tabindex="-1"></a>               <span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb80-34"><a href="#cb80-34" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb80-35"><a href="#cb80-35" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">9</span>, <span class="at">ncol =</span>  <span class="dv">9</span>)</span>
<span id="cb80-36"><a href="#cb80-36" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb80-37"><a href="#cb80-37" tabindex="-1"></a>s.A <span class="ot">&lt;-</span> <span class="fu">game</span>(A)</span>
<span id="cb80-38"><a href="#cb80-38" tabindex="-1"></a>s.B <span class="ot">&lt;-</span> <span class="fu">game</span>(A <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb80-39"><a href="#cb80-39" tabindex="-1"></a>action.B <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cbind</span>(s.B<span class="sc">$</span>x, s.B<span class="sc">$</span>y), <span class="dv">6</span>)</span>
<span id="cb80-40"><a href="#cb80-40" tabindex="-1"></a><span class="fu">colnames</span>(action.B) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Game B, Player 1&quot;</span>,<span class="st">&quot;Game B, Player 2&quot;</span>)</span>
<span id="cb80-41"><a href="#cb80-41" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(action.B, <span class="at">align =</span> <span class="st">&quot;ccc&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Game B, Player 1</th>
<th align="center">Game B, Player 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">x1</td>
<td align="center">0.000000</td>
<td align="center">0.000000</td>
</tr>
<tr class="even">
<td align="left">x2</td>
<td align="center">0.000000</td>
<td align="center">0.000000</td>
</tr>
<tr class="odd">
<td align="left">x3</td>
<td align="center">0.409836</td>
<td align="center">0.409836</td>
</tr>
<tr class="even">
<td align="left">x4</td>
<td align="center">0.000000</td>
<td align="center">0.000000</td>
</tr>
<tr class="odd">
<td align="left">x5</td>
<td align="center">0.327869</td>
<td align="center">0.327869</td>
</tr>
<tr class="even">
<td align="left">x6</td>
<td align="center">0.000000</td>
<td align="center">0.000000</td>
</tr>
<tr class="odd">
<td align="left">x7</td>
<td align="center">0.262295</td>
<td align="center">0.262295</td>
</tr>
<tr class="even">
<td align="left">x8</td>
<td align="center">0.000000</td>
<td align="center">0.000000</td>
</tr>
<tr class="odd">
<td align="left">x9</td>
<td align="center">0.000000</td>
<td align="center">0.000000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;It is the extreme points (11.15) of the original game A</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## It is the extreme points (11.15) of the original game A</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The value of game A is&quot;</span>,s.A<span class="sc">$</span>v,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">The value of game B is&quot;</span>,s.B<span class="sc">$</span>v)</span></code></pre></div>
<pre><code>## The value of game A is 0 
## The value of game B is 2</code></pre>
</div>
</div>
</div>
<div id="homework-9" class="section level1">
<h1>Homework 9</h1>
<div id="questions-9" class="section level2">
<h2>Questions</h2>
<div id="exercise-4." class="section level3">
<h3>2.1.3 Exercise 4.</h3>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
</div>
<div id="exercise-1.-10" class="section level3">
<h3>2.3.1 Exercise 1.</h3>
<p>What does dim() return when applied to a vector?</p>
</div>
<div id="exercise-2.-2" class="section level3">
<h3>2.3.1 Exercise 2.</h3>
<p>If is.matrix(x) is TRUE, what will is.array(x) return?</p>
</div>
<div id="exercise-2.-3" class="section level3">
<h3>2.4.5 Exercise 2.</h3>
<p>What does as.matrix() do when applied to a data frame with columns of
different types?</p>
</div>
<div id="exercise-3." class="section level3">
<h3>2.4.5 Exercise 3.</h3>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
</div>
<div id="exercises-2." class="section level3">
<h3>Exercises 2.</h3>
<p>The function below scales a vector so it falls in the range [0, 1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="exercises-1." class="section level3">
<h3>Exercises 1.</h3>
<p>Use vapply() to:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the standard deviation of every column in a numeric data
frame.</p></li>
<li><p>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply() twice.)</p></li>
</ol>
</div>
<div id="exercise-9.8" class="section level3">
<h3>Exercise 9.8</h3>
<p>Consider Exercise 9.8 (pages 278, Statistical Computing with R).
(Hint: Refer to the first example of Case studies section)</p>
<p>Exercise 9.8. This example appears in [40]. Consider the bivariate
density <span class="math display">\[
\begin{align}
f(x,y)\propto\left(
\begin{matrix}
n \\ x
\end{matrix}\right)
y^{x+a-1}(1-y)^{n-x+b-1},~~x=0,1,\cdots,n,~~0\le y\le 1.
\end{align}
\]</span> It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(n\)</span>, the conditional distributions are
Binomial<span class="math inline">\((n, y)\)</span> and Beta<span class="math inline">\((x + a, n − x + b)\)</span>. Use the Gibbs sampler
to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<ul>
<li>Write an R function.</li>
<li>Write an Rcpp function.</li>
<li>Compare the computation time of the two functions with the function
“microbenchmark”</li>
</ul>
</div>
</div>
<div id="answers-9" class="section level2">
<h2>Answers</h2>
<div id="exercise-4.-1" class="section level3">
<h3>2.1.3 Exercise 4.</h3>
<p>In R, <em>unlist()</em> is used to recursively flatten a list into an
atomic vector, ensuring uniform element types. It handles nested
structures, producing a single vector.</p>
<p><em>as.vector()</em> is designed to convert objects into vectors, but
when dealing with lists, it may not recursively flatten internal
structures. This can result in the output still being a list rather than
an atomic vector.</p>
<p>There is an example.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a><span class="fu">unlist</span>(x)</span></code></pre></div>
<pre><code>## [1] 1 2 1 2 3 4</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="fu">as.vector</span>(x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1 2
## 
## [[2]]
## [1] 1 2 3 4</code></pre>
</div>
<div id="exercise-1.-11" class="section level3">
<h3>2.3.1 Exercise 1.</h3>
<p>For a vector <span class="math inline">\(X\)</span>, <em>dim()</em>
function will return NULL.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a><span class="fu">is.vector</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="fu">dim</span>(x)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;logical&quot;</span>,<span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a><span class="fu">is.vector</span>(y)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="fu">dim</span>(y)</span></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
<div id="exercise-2.-4" class="section level3">
<h3>2.3.1 Exercise 2.</h3>
<p><em>is.array(x)</em> will return TRUE if <em>is.matrix(x)</em> is
TRUE.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="at">nrow =</span> <span class="dv">4</span>,<span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a><span class="fu">is.matrix</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">is.array</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="exercise-2.-5" class="section level3">
<h3>2.4.5 Exercise 2.</h3>
<p>For <em>x</em> is a data frame with columns of different types,
<em>as.matrix(x)</em> is a charavter matrix.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">b=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>),<span class="at">c=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>))</span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">class</span>(x[,<span class="dv">1</span>]),<span class="fu">class</span>(x[,<span class="dv">2</span>]),<span class="fu">class</span>(x[,<span class="dv">3</span>]))</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;   &quot;character&quot; &quot;logical&quot;</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(x)</span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a>y</span></code></pre></div>
<pre><code>##      a   b   c      
## [1,] &quot;1&quot; &quot;A&quot; &quot;TRUE&quot; 
## [2,] &quot;2&quot; &quot;B&quot; &quot;TRUE&quot; 
## [3,] &quot;3&quot; &quot;C&quot; &quot;FALSE&quot;
## [4,] &quot;4&quot; &quot;D&quot; &quot;FALSE&quot;</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="fu">class</span>(y)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">typeof</span>(y)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
</div>
<div id="exercise-3.-1" class="section level3">
<h3>2.4.5 Exercise 3.</h3>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">numeric</span>(<span class="dv">0</span>),<span class="at">b=</span><span class="fu">logical</span>(<span class="dv">0</span>))</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">nrow</span>(x),<span class="fu">ncol</span>(x))</span></code></pre></div>
<pre><code>## [1] 0 2</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">data.frame</span>()</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">nrow</span>(y),<span class="fu">ncol</span>(y))</span></code></pre></div>
<pre><code>## [1] 0 0</code></pre>
</div>
<div id="exercises-2.-1" class="section level3">
<h3>Exercises 2.</h3>
<p>If the elements of the data frame are all numerical, we use
<em>apply()</em> function. If some columns in the data frame are not
numerical, we can first use <em>sapply()</em> function and then use
<em>apply()</em> function.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb114-5"><a href="#cb114-5" tabindex="-1"></a>}</span>
<span id="cb114-6"><a href="#cb114-6" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">4</span>,<span class="dv">5</span>))</span>
<span id="cb114-7"><a href="#cb114-7" tabindex="-1"></a><span class="fu">apply</span>(x,<span class="dv">2</span>,scale01)</span></code></pre></div>
<pre><code>##             V1        V2        V3        V4        V5
## [1,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
## [2,] 0.3333333 0.3333333 0.3333333 0.3333333 0.3333333
## [3,] 0.6666667 0.6666667 0.6666667 0.6666667 0.6666667
## [4,] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">b=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>),<span class="at">c=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>))</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>index<span class="ot">&lt;-</span><span class="fu">sapply</span>(y,is.numeric)</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">as.matrix</span>(y[,<span class="fu">which</span>(index<span class="sc">==</span><span class="dv">1</span>)]),<span class="dv">2</span>,scale01)</span></code></pre></div>
<pre><code>##           [,1]
## [1,] 0.0000000
## [2,] 0.3333333
## [3,] 0.6666667
## [4,] 1.0000000</code></pre>
</div>
<div id="exercises-1.-1" class="section level3">
<h3>Exercises 1.</h3>
<p>(a).</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">4</span>,<span class="dv">5</span>))</span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a><span class="fu">vapply</span>(x,sd,<span class="at">FUN.VALUE =</span> <span class="fu">c</span>(<span class="at">sd=</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>##       V1       V2       V3       V4       V5 
## 1.290994 1.290994 1.290994 1.290994 1.290994</code></pre>
<p>(b).</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">b=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>),<span class="at">c=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>))</span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a>index<span class="ot">&lt;-</span><span class="fu">vapply</span>(x,is.numeric,<span class="at">FUN.VALUE =</span> <span class="fu">c</span>(<span class="at">I=</span><span class="dv">1</span>))</span>
<span id="cb120-4"><a href="#cb120-4" tabindex="-1"></a><span class="fu">vapply</span>(x[,<span class="fu">which</span>(index<span class="sc">==</span><span class="dv">1</span>)],sd,<span class="at">FUN.VALUE =</span> <span class="fu">c</span>(<span class="at">sd=</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        a        c 
## 1.290994 4.787136</code></pre>
</div>
<div id="exercise-9.8-1" class="section level3">
<h3>Exercise 9.8</h3>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fl">1e+4</span></span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a><span class="co"># R function</span></span>
<span id="cb122-4"><a href="#cb122-4" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x,y,a,b,n){</span>
<span id="cb122-5"><a href="#cb122-5" tabindex="-1"></a>  <span class="fu">choose</span>(n,x)<span class="sc">*</span>y<span class="sc">^</span>(x<span class="sc">+</span>a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span>(n<span class="sc">-</span>x<span class="sc">+</span>b<span class="dv">-1</span>)</span>
<span id="cb122-6"><a href="#cb122-6" tabindex="-1"></a>}</span>
<span id="cb122-7"><a href="#cb122-7" tabindex="-1"></a>joint.density.R<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">init.x=</span><span class="dv">0</span>,<span class="at">init.y=</span><span class="dv">0</span>,<span class="at">a=</span><span class="dv">5</span>,<span class="at">b=</span><span class="dv">5</span>,<span class="at">n=</span><span class="dv">20</span>){</span>
<span id="cb122-8"><a href="#cb122-8" tabindex="-1"></a>  z<span class="ot">&lt;-</span>x<span class="ot">&lt;-</span>y<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb122-9"><a href="#cb122-9" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span>init.x</span>
<span id="cb122-10"><a href="#cb122-10" tabindex="-1"></a>  y[<span class="dv">1</span>]<span class="ot">&lt;-</span>init.y</span>
<span id="cb122-11"><a href="#cb122-11" tabindex="-1"></a>  z[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">f</span>(x[<span class="dv">1</span>],y[<span class="dv">1</span>],a,b,n)</span>
<span id="cb122-12"><a href="#cb122-12" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb122-13"><a href="#cb122-13" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,y[i<span class="dv">-1</span>])</span>
<span id="cb122-14"><a href="#cb122-14" tabindex="-1"></a>    y[i]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>]<span class="sc">+</span>a,n<span class="sc">-</span>x[i<span class="dv">-1</span>]<span class="sc">+</span>b)</span>
<span id="cb122-15"><a href="#cb122-15" tabindex="-1"></a>    z[i]<span class="ot">&lt;-</span><span class="fu">f</span>(x[i],y[i],a,b,n)</span>
<span id="cb122-16"><a href="#cb122-16" tabindex="-1"></a>  }</span>
<span id="cb122-17"><a href="#cb122-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(x,y,z))</span>
<span id="cb122-18"><a href="#cb122-18" tabindex="-1"></a>}</span>
<span id="cb122-19"><a href="#cb122-19" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">joint.density.R</span>()[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>(N<span class="sc">/</span><span class="dv">2</span>)),]</span>
<span id="cb122-20"><a href="#cb122-20" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##       x         y            z
## 5001 11 0.1591775 1.881853e-08
## 5002  1 0.4481823 4.164878e-07
## 5003 10 0.2371019 7.416880e-06
## 5004  7 0.5875188 6.464334e-05
## 5005  9 0.3823376 4.552863e-04
## 5006  4 0.3690715 1.666405e-04</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="co"># library(plotly)</span></span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a><span class="co"># p&lt;-plot_ly(data,x=~x,y=~y,z=~z) %&gt;% add_markers(color = ~z)</span></span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a><span class="co"># p</span></span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="co"># Rcpp function</span></span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&quot;joint.density.cpp&quot;</span>)</span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">joint_density_cpp</span>())[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>(N<span class="sc">/</span><span class="dv">2</span>)),]</span>
<span id="cb125-5"><a href="#cb125-5" tabindex="-1"></a><span class="fu">colnames</span>(data)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>)</span>
<span id="cb125-6"><a href="#cb125-6" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##       x         y            z
## 5001  5 0.4490377 1.387730e-04
## 5002  5 0.3364761 3.534326e-04
## 5003  7 0.3540725 5.041412e-04
## 5004  7 0.4212354 5.268907e-04
## 5005 11 0.4926478 6.057288e-04
## 5006  7 0.6612880 8.333552e-06</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a><span class="co"># p&lt;-plot_ly(data,x=~x,y=~y,z=~z) %&gt;% add_markers(color = ~z)</span></span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a><span class="co"># p</span></span></code></pre></div>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>ts<span class="ot">&lt;-</span><span class="fu">microbenchmark</span>(<span class="at">joint.R=</span><span class="fu">joint.density.R</span>(),<span class="at">joint.cpp=</span><span class="fu">joint_density_cpp</span>())</span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##        expr       lq   median      uq
## 1   joint.R 71.52840 73.26515 74.9884
## 2 joint.cpp 23.72655 26.19085 28.5205</code></pre>
<p>Rcpp function is below.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp<span class="op">;</span></span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a>NumericMatrix joint_density_cpp<span class="op">(</span><span class="dt">double</span> init_x<span class="op">=</span><span class="dv">0</span><span class="op">,</span><span class="dt">double</span> init_y<span class="op">=</span><span class="dv">0</span><span class="op">,</span><span class="dt">int</span> a<span class="op">=</span><span class="dv">5</span><span class="op">,</span><span class="dt">int</span> b<span class="op">=</span><span class="dv">5</span><span class="op">,</span><span class="dt">int</span> n<span class="op">=</span><span class="dv">20</span><span class="op">){</span></span>
<span id="cb130-5"><a href="#cb130-5" tabindex="-1"></a>  Environment glo<span class="op">=</span>Environment<span class="op">::</span>global_env<span class="op">();</span></span>
<span id="cb130-6"><a href="#cb130-6" tabindex="-1"></a>  Function f<span class="op">=</span>glo<span class="op">[</span><span class="st">&quot;f&quot;</span><span class="op">];</span></span>
<span id="cb130-7"><a href="#cb130-7" tabindex="-1"></a>  <span class="dt">int</span> N<span class="op">=</span>as<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span>glo<span class="op">[</span><span class="st">&quot;N&quot;</span><span class="op">]);</span></span>
<span id="cb130-8"><a href="#cb130-8" tabindex="-1"></a>  NumericMatrix res<span class="op">(</span>N<span class="op">,</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb130-9"><a href="#cb130-9" tabindex="-1"></a>  res<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">)=</span>init_x<span class="op">;</span></span>
<span id="cb130-10"><a href="#cb130-10" tabindex="-1"></a>  res<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">)=</span>init_y<span class="op">;</span></span>
<span id="cb130-11"><a href="#cb130-11" tabindex="-1"></a>  res<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">2</span><span class="op">)=</span>as<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>f<span class="op">(</span>res<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">),</span>res<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">),</span>a<span class="op">,</span>b<span class="op">,</span>n<span class="op">));</span></span>
<span id="cb130-12"><a href="#cb130-12" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;</span>N<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb130-13"><a href="#cb130-13" tabindex="-1"></a>    res<span class="op">(</span>i<span class="op">,</span><span class="dv">0</span><span class="op">)=</span>as<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>Rcpp<span class="op">::</span>rbinom<span class="op">(</span><span class="dv">1</span><span class="op">,</span>n<span class="op">,</span>res<span class="op">(</span>i<span class="op">-</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">)));</span></span>
<span id="cb130-14"><a href="#cb130-14" tabindex="-1"></a>    res<span class="op">(</span>i<span class="op">,</span><span class="dv">1</span><span class="op">)=</span>as<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>Rcpp<span class="op">::</span>rbeta<span class="op">(</span><span class="dv">1</span><span class="op">,</span>res<span class="op">(</span>i<span class="op">-</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">)+</span>a<span class="op">,</span>n<span class="op">-</span>res<span class="op">(</span>i<span class="op">-</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">)+</span>b<span class="op">));</span></span>
<span id="cb130-15"><a href="#cb130-15" tabindex="-1"></a>    res<span class="op">(</span>i<span class="op">,</span><span class="dv">2</span><span class="op">)=</span>as<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>f<span class="op">(</span>res<span class="op">(</span>i<span class="op">,</span><span class="dv">0</span><span class="op">),</span>res<span class="op">(</span>i<span class="op">,</span><span class="dv">1</span><span class="op">),</span>a<span class="op">,</span>b<span class="op">,</span>n<span class="op">));</span></span>
<span id="cb130-16"><a href="#cb130-16" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb130-17"><a href="#cb130-17" tabindex="-1"></a>  <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb130-18"><a href="#cb130-18" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
